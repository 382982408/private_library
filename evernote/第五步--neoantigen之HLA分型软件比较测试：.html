<html>
<head>
  <title>第五步--neoantigen之HLA分型软件比较测试：</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="949"/>
<h1>第五步--neoantigen之HLA分型软件比较测试：</h1>

<div>
<span><div><span style="font-size: 16pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">第五步--neoantigen之HLA分型软件比较测试：</span></div><div><span style="font-family: &quot;Times New Roman&quot;;">博客分享之HLA</span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">分型软件总结：</span><a href="http://blog.sciencenet.cn/blog-623545-1095320.html" style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">http://blog.sciencenet.cn/blog-623545-1095320.html</a></div><div><br/></div><div><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;">1） Optitype 2014  </span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                分析范围：</span><span style="font-size: 10pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;">class I (HLA-A, B,-C) ，据他人比较其提供的4位分型结果的准确率高于HLAminer和HLAforest。</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                github 地址如下：</span><a href="https://github.com/FRED-2/OptiType" style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">https://github.com/FRED-2/OptiType</a></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                docker 镜像：docker pull fred2/optitype <span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;; color: rgb(255, 0, 0);">（可用）</span></span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                应用说明：</span><a href="https://www.jianshu.com/p/6dc04e44b465" style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">https://www.jianshu.com/p/6dc04e44b465</a></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                示例：docker run -v /home/luozw/work_dir/Optitype_test/:/data/ -t fred2/optitype -i /data/199003864TD_HUM_C_GC1A_543_Z_0_A_190501_Q100020010_V300018618_L004_1.fq.gz /data/199003864TD_HUM_C_GC1A_543_Z_0_A_190501_Q100020010_V300018618_L004_2.fq.gz  -d -o ./ (</span><span style="font-size: 10pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;">数据一定要放在在/home及其子目录下才行，不然访问不到</span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">)</span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">            sge SHELL地址：</span><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">/mnt/X500/farmers/luozw/factory/20190902_hla_loh/OptiType/test/analysis_hlatype_OptiType.sh</span></font></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">                                            </span></font><span style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">analysis_hlatype_OptiType.sh &lt;normal_bam&gt; &lt;out_dir&gt;</span></span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                <span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;; color: rgb(77, 206, 29);">测试结果：程序成熟，运行简单，高效率，5分钟解决问题，但是只能进行I类分型。</span></span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-size: 14pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">2） Polysolver 2015 </span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                </span></font><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">分析范围</span><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">：</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">class I (HLA-A, -B, -C)</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                github 地址如下：</span><a href="https://github.com/jason-weirather/hla-polysolver">https://github.com/jason-weirather/hla-polysolver</a> （非polysover官网版本，私人修正版）</div><div>                                         <a href="https://github.com/researchapps/polysolver" style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">https://github.com/researchapps/polysolver</a> （git clone 即可）</div><div>              docker镜像地址：<a href="https://hub.docker.com/r/sachet/polysolver">https://hub.docker.com/r/sachet/polysolver</a> ，docker pull sachet/polysolver:v4（<span style="color: rgb(227, 0, 0);">依赖PolyOmica/singularity才能执行</span>）</div><div>              示例：</div><div><span style="color: rgb(77, 206, 29);">              测试结果：git上的流程测试不通，暂时没有花时间去研究。</span></div><div><br/></div><div><span style="font-size: 14pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">3）HLA  reporter </span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                </span></font><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">分析范围</span><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">：</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">可以同时对HlA I型基因和II 型基因进行分型</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;"><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;; color: rgb(227, 0, 0);">   </span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;; color: rgb(227, 0, 0);">    </span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;; color: rgb(227, 0, 0);"> </span>        </span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">软件官网:</span> <a href="http://paed.hku.hk/genome/software.html" style="font-size: 10pt; color: rgb(77, 206, 29); font-family: &quot;Times New Roman&quot;;">http://paed.hku.hk/genome/software.html</a></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                地址如下：wget http://paed.hku.hk/genome/software/HLAreporter.zip （unzip HLAreporter.zip即可用）</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                docker版地址：</span><span style="font-family: &quot;Times New Roman&quot;;"><a href="https://hub.docker.com/r/aniroula/hlareporter" style="font-family: &quot;Times New Roman&quot;;">https://hub.docker.com/r/aniroula/hlareporter</a>，</span><span style="font-family: &quot;Times New Roman&quot;;">docker pull aniroula/hlareporter</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                应用说明：</span><a href="https://www.jianshu.com/p/7f500d949713" style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">https://www.jianshu.com/p/7f500d949713</a></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                示例：</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">一定要在主shell所在目录运行</span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;"> sh ./HLAreporter.sh sample_name gene_name fq1 fq2 </span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                预测原理：exons 2, 3, and 4 for class I genes HLA-A, HLA-B, and HLA-C, and exons 2 and 3 for the class II genes</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                <span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;; color: rgb(77, 206, 29);">测试结果：测试不通。</span></span></div><div><font face="Times New Roman" style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 14pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">4）HLA miner </span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">    </span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">            </span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">分析范围：</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">可以同时对HlA I型基因和II 型基因进行分型， 2或者4位分型 <span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">（DNA和RNA 数据都支持：WGS+RNA）</span></span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                支持数据： (whole genome, whole transcriptome, exome数据) （from Illumina, PacBio and Oxford Nanopore）</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                官网如下：</span><a href="https://github.com/warrenlr/HLAminer" style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">https://github.com/warrenlr/HLAminer</a></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                下载地址：</span><a href="http://www.bcgsc.ca/platform/bioinfo/software/hlaminer" style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">http://www.bcgsc.ca/platform/bioinfo/software/hlaminer</a><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">(v.14)</span></div><div>               docker地址：<a href="https://hub.docker.com/r/mclaugsf/hlaminer">https://hub.docker.com/r/mclaugsf/hlaminer</a>，docker pull mclaugsf/hlaminer:v3  <span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">（v1.3）</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                 HLAminer有两种策略可供选择：基于目的片段组装的HPTASR和基于序列比对的HPRA</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                 应用说明：</span><a href="https://www.jianshu.com/p/2ec132f4a6c6" style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">https://www.jianshu.com/p/2ec132f4a6c6</a><span style="font-size: 10pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;">（组装算法</span><span style="font-size: 10pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;">--fa.gz文件一定不能链接为--.fa，会出问题</span><span style="font-size: 10pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;">）</span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(77, 206, 29); font-family: &quot;Times New Roman&quot;;">                 测试结果：程序很不好用，基于序列比对的HPRA算法处理25分钟左右，可以进行I、II类分型，但是据别人研究，此算法结果准确性不高。</span></span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; color: rgb(77, 206, 29); font-family: &quot;Times New Roman&quot;;">                                     基于组装算法比较慢，一周了还没跑完，杀死任务，无结果。</span></span></div><div>            <span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">sge SHELL地址：</span></div><div><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">                    WGS：</span><span style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">/mnt/X500/farmers/luozw/bin/HLAminer-1.4/HLAminer_v1.4/bin/HPRAwgs_classI-II.sh</span></span></div><div><span style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">                                    </span></span><span style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">HPRAwgs_classI-II</span></span><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;"><b>_from_fq.sh</b></span> <span style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">&lt;fq1&gt; &lt;fq2&gt; &lt;out_dir&gt;</span></span></div><div><span style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;"><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span></span></span><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;"><b>HPRAwgs_classI-II.sh &lt;bam&gt; &lt;out_dir&gt;</b></span></div><div><span style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">                    RNA：</span></span><span style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">/mnt/X500/farmers/luozw/bin/HLAminer-1.4/HLAminer_v1.4/bin/HPRArnaseq_classI-II.sh</span></span></div><div><span style="font-size: 14pt;"><br/></span></div><div><span style="font-size: 14pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">5）Athlates</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                    分析范围：</span> <span style="color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">HLA-A, -B, -C, -DRB1 and -DQB1 genes</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                    文章：ATHLATES:accurate typing of human leukocyte antigen through exome sequencing.</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                    github地址：</span><a href="https://github.com/cliu32/athlates" style="font-family: &quot;Times New Roman&quot;;">https://github.com/cliu32/athlates</a></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                    docker地址：</span><span style="font-family: &quot;Times New Roman&quot;;"><a href="https://hub.docker.com/r/sherryzhangjax/athlates" style="font-family: &quot;Times New Roman&quot;;">https://hub.docker.com/r/sherryzhangjax/athlates</a>，</span><span style="font-family: &quot;Times New Roman&quot;;">docker pull sherryzhangjax/athlates <span style="font-family: &quot;Times New Roman&quot;; color: rgb(255, 0, 0);">（垃圾镜像）</span></span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                    </span><span style="color: rgb(77, 206, 29); font-family: &quot;Times New Roman&quot;;">测试结果：未找到成熟软件，无测试</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                </span></div><div><span style="font-size: 14pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">6）HLA-HD</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                    分析范围：</span> <span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 14px; color: rgb(255, 0, 0); font-family: &quot;open sans&quot;, &quot;clear sans&quot;, &quot;helvetica neue&quot;, helvetica, arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">可以对classI、ClassII、ClassIII全部进行分型。</span></span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                    文章：</span><span style="font-family: &quot;Times New Roman&quot;;">HLA-HD An accurate HLA typing algorithm for next-generation sequencing data</span></div><div><span style="font-family: &quot;Times New Roman&quot;;">                     软件地址：</span><span style="font-family: &quot;Times New Roman&quot;;"><a href="https://www.genome.med.kyoto-u.ac.jp/HLA-HD/" style="font-family: &quot;Times New Roman&quot;;">https://www.genome.med.kyoto-u.ac.jp/HLA-HD/</a>  （已经不可访问）</span></div><div><span style="font-family: &quot;Times New Roman&quot;;">                     docker地址：</span><span style="font-family: &quot;Times New Roman&quot;;"><a href="https://hub.docker.com/r/jianhung/hla-hd/tags" style="font-family: &quot;Times New Roman&quot;;">https://hub.docker.com/r/jianhung/hla-hd/tags</a>，</span><span style="font-family: &quot;Times New Roman&quot;;">docker pull jianhung/hla-hd <span style="font-family: &quot;Times New Roman&quot;; color: rgb(255, 0, 0);">（</span></span><span style="color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;">垃圾镜像）</span></div><div><span style="color: rgb(77, 206, 29); font-family: &quot;Times New Roman&quot;;">                     测试结果：软件官网已不能访问，无测试。</span></div><div><font face="Times New Roman" style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;;">7）SOAP-HLA</span></div><div><span style="font-size: 10pt;">                  文章：</span><span style="font-size: 10pt; background-color: rgb(255, 255, 255); color: rgba(0, 0, 0, 0.87); font-family: Roboto; font-weight: bold;">An Integrated Tool to Study MHC Region: Accurate SNV Detection and HLA Genes Typing in Human MHC Region Using Targeted High-Throughput Sequencing</span></div><div>                   官网地址：<a href="https://omictools.com/soap-hla-tool">https://omictools.com/soap-hla-tool</a>   </div><div><span style="color: rgb(77, 206, 29);">                   测试结果： This tool is not available anymore.无测试。</span></div><div><br/></div><div><span style="font-size: 14pt; color: rgb(255, 0, 0);">8）</span> <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 14pt; color: rgb(255, 0, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">HLAforest</span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 14pt; color: rgb(255, 0, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">             </span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">分析范围：</span> <span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: &quot;open sans&quot;, &quot;clear sans&quot;, &quot;helvetica neue&quot;, helvetica, arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">classI</span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(47, 47, 47); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">                    支持数据：</span> <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 10pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">RNA_seq数据</span></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(47, 47, 47); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">                    github地址：</span> <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(247, 247, 247);"><a href="https://github.com/FNaveed786/hlaforest" style="font-size: 10pt; background-color: rgb(247, 247, 247); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">https://github.com/FNaveed786/hlaforest</a></span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                    应用说明：</span><a href="https://www.jianshu.com/p/9197584149f3" style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">https://www.jianshu.com/p/9197584149f3</a></div><div><span style="color: rgb(77, 206, 29);">                 测试结果：依赖RNA数据，无测试。</span></div><div><br/></div><div><span style="font-size: 14pt; color: rgb(227, 0, 0);">9） seq2HLA </span></div><div>                 <span style="font-size: 10pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(47, 47, 47); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">支持数据：</span> <span style="font-size: 10pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">RNA_seq数据</span></div><div><span style="font-size: 10pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">                    </span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">分析范围：</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">可以同时对HlA I型基因和II 型基因进行分型， 2或者4位分型（</span> <span style="color: rgb(227, 0, 0);">Class I and </span><span style="font-size: 15px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(247, 247, 247); color: rgb(227, 0, 0); font-family: Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Class II</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">）</span></div><div><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">                    应用说明：</span><a href="https://www.jianshu.com/p/f46e631ebd55" style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;;">https://www.jianshu.com/p/f46e63    1ebd55</a></div><div>                                    <a href="http://www.bio-info-trainee.com/tag/hla%E5%88%86%E5%9E%8B">http://www.bio-info-trainee.com/tag/hla%E5%88%86%E5%9E%8B</a></div><div>                 github地址：<a href="https://github.com/TRON-Bioinformatics/seq2HLA">https://github.com/TRON-Bioinformatics/seq2HLA</a> （<span style="color: rgb(227, 0, 0);">测试可用，较docker 上版本更新。II类分型结果更多</span>）</div><div>                 docker地址：jemimalwh/seq2hla:v0.1    （测试可用）</div><div>                 应用示例：python ../seq2HLA.py -1 1.fq.gz -2 2.fq.gz -r test -p 4 &amp;</div><div>                 示例结果：/mnt/X500/farmers/luozw/bin/seq2HLA/test</div><div>                 <span style="color: rgb(77, 206, 29);">测试结果：测试畅通，依赖python2.7 和bowtie，20分钟左右，I-II类分型结果都有。</span></div><div><br/></div><div><span style="font-size: 14pt;">10）HLA-LA</span></div><div><span style="font-size: 14pt;">       </span> <span style="font-size: 10pt;">支持数据：</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: Roboto; font-variant-caps: normal; font-variant-ligatures: normal;">from whole-genome and whole-exome Illumina data</span></div><div><font style="font-size: 10pt;"><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-caps: normal; font-variant-ligatures: normal;"><span style="font-size: 10pt; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-caps: normal; font-variant-ligatures: normal; color: rgb(255, 0, 0);">           </span> <span style="font-size: 10pt; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">文章</span><span style="font-size: 10pt; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-caps: normal; font-variant-ligatures: normal; color: rgb(255, 0, 0);">：</span></span><span style="letter-spacing: -0.03em; font-size: 10pt; color: rgb(19, 19, 19); font-family: GillSansRegular, &quot;Gill Sans MT&quot;, &quot;Gill Sans&quot;, Helvetica, Arial, sans-serif; font-weight: bold;">HLA*PRG:LA – HLA typing from linearly projected graph alignments （</span></font><a href="https://www.biorxiv.org/content/biorxiv/early/2018/10/26/453555.full.pdf" style="font-family: GillSansRegular; font-weight: bold;">https://www.biorxiv.org/content/biorxiv/early/2018/10/26/453555.full.pdf</a><font style="font-size: 10pt;"><span style="letter-spacing: -0.03em; font-size: 10pt; color: rgb(19, 19, 19); font-family: GillSansRegular, &quot;Gill Sans MT&quot;, &quot;Gill Sans&quot;, Helvetica, Arial, sans-serif; font-weight: bold;">）</span></font></div><div><span style="font-size: 10pt;">           分析范围：</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">（</span> <span style="color: rgb(227, 0, 0);">Class I and </span><span style="font-size: 15px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(247, 247, 247); color: rgb(227, 0, 0); font-family: Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Class II</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">）</span></div><div><span style="font-size: 10pt;">           github地址：</span><a href="https://github.com/DiltheyLab/HLA-LA">https://github.com/DiltheyLab/HLA-LA</a></div><div>                                <a href="https://github.com/DiltheyLab/HLA-LA/blob/master/HLA-ASM.md">https://github.com/DiltheyLab/HLA-LA/blob/master/HLA-ASM.md</a></div><div>                                 conda install hla-la</div><div>            用法说明：</div><div>              <span style="color: rgb(255, 0, 0);">  1) GRCH37、38版本的bam 都可以，程序自动识别。</span></div><div>                    HLA*LA tries to <span style="font-weight: bold;">automatically figure out the right reference genome for your BAM</span>. It compares the index of your BAM/CRAM with a database of known references, that contains the regions relevant for HLA typing. Reads from these regions are extracted and processed. We currently have support for various versions of B37 and for the 1000 Genomes GRCh38 reference. If the program complains that it cannot find a compatible entry in its internal database, please get in touch - adding more references is easy (see below), and we want to support as wide a range of popular references as possible! <span style="font-weight: bold;">You do not need to modify the utilized graph depending on whether your BAM uses GRCh37 or GRCh38.   </span></div><div>                2) 目录结构</div><div>                    2.1）mkdir HLA-LA HLA-LA/bin HLA-LA/src HLA-LA/obj HLA-LA/temp HLA-LA/working HLA-LA/graphs</div><div>                    2.2）Clone this repository into HLA-LA/src:cd HLA-LA/src; git clone <a href="https://github.com/DiltheyLab/HLA-LA.git">https://github.com/DiltheyLab/HLA-LA.git</a> .</div><div>                3）数据准备</div><div>                    3.1）cd HLA-LA/graphs &amp;&amp; wget   <a href="http://www.well.ox.ac.uk/downloads/PRG_MHC_GRCh38_withIMGT.tar.gz">http://www.well.ox.ac.uk/downloads/PRG_MHC_GRCh38_withIMGT.tar.gz</a>, &amp;&amp; tar -xvzf PRG_MHC_GRCh38_withIMGT.tar.gz</div><div>                    3.2)../bin/HLA-LA --action prepareGraph --PRG_graph_dir ../graphs/PRG_MHC_GRCh38_withIMGT</div><div>                4) 配置文件修改</div><div>                    4.1）src/paths.ini  修改其中 工具bin 地址（<span style="color: rgb(255, 0, 0); font-weight: bold;">程序路径是文</span><span style="color: rgb(255, 0, 0); font-weight: bold;">件，不是目录</span>）。</div><div>                5）HLA-LA 分型</div><div>           <span style="font-weight: bold;"> </span><span style="font-weight: bold;">        ./HLA-LA.pl --BAM /path/to/indexed.bam --graph PRG_MHC_GRCh38_withIMGT --sampleID $mySampleID --maxThreads 7 </span><span style="font-weight: bold;">--workingDir out_dir</span></div><div style="margin-left: 80px;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;; font-weight: bold;">sge SHELL地址：</span><span style="font-size: 12pt; color: rgb(255, 70, 53);">perl  /mnt/X500/farmers/luozw/bin/anaconda/envs/hla-la/opt/hla-la/src/HLA-LA.pl</span></div><div style="margin-left: 80px;"><span style="font-weight: bold;">        --BAM    /path/to/indexed.bam</span></div><div style="margin-left: 80px;"><span style="font-weight: bold;">        --graph    PRG_MHC_GRCh38_withIMGT</span></div><div style="margin-left: 80px;"><span style="font-weight: bold;">        --sampleID    mySampleID</span></div><div style="margin-left: 80px;"><span style="font-weight: bold;">        --workingDir    OutDir</span></div><div>        <span style="color: rgb(255, 0, 0); font-weight: bold;">        6）运行顺利，但是比较慢，WES花费了4个小时。</span></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">                     结果文件：</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;"> </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">../working/$mySampleID/hla/R1_bestguess_G.txt</span></div><div><br/></div><div><span style="font-size: 14pt;">11）</span><span style="font-size: 14pt;">HLA</span></div><div><span style="font-size: 10pt;">    </span><span style="font-size: 10pt;">    </span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">    支持数据：</span> <font face="Times New Roman" style="font-size: 10pt;"><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; font-family: &quot;Times New Roman&quot;; color: rgb(36, 41, 46); font-variant-caps: normal; font-variant-ligatures: normal;">xHLA: Fast and accurate HLA typing from short read sequence data</span></font></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(36, 41, 46); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">             文章：</span> <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(36, 41, 46); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">Xie et al. (2017) Fast and accurate HLA typing from short-read next-generation sequence data with xHLA.</span><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 10pt; color: rgb(36, 41, 46); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;"> </span><span style="box-sizing: border-box; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 10pt; color: rgb(36, 41, 46); font-family: &quot;Times New Roman&quot;; font-style: italic; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">PNAS</span><a href="http://www.pnas.org/content/early/2017/06/27/1707945114" style="box-sizing: border-box; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(3, 102, 214); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">doi:10.1073/pnas.1707945114</a></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(36, 41, 46); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">             </span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;">分析范围：</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">（</span><span style="font-size: 10pt; font-family: &quot;Times New Roman&quot;;"> </span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">Class I and </span><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(247, 247, 247); font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">Class II</span><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">）</span></div><div><span style="font-size: 10pt; color: rgb(227, 0, 0); font-family: &quot;Times New Roman&quot;;">             git-hub地址：</span><a href="https://github.com/humanlongevity/HLA" style="font-family: &quot;Times New Roman&quot;;">https://github.com/humanlongevity/HLA</a></div><div>            docker：docker pull humanlongevity/hla</div><div>            docker run -v `pwd`:`pwd` \</div><div>                    -w `pwd` humanlongevity/hla \</div><div>                    --sample_id test \</div><div>                    --input_bam_path tests/test.bam \</div><div>                    --output_path test</div><div>            用法说明：</div><div>                1）package配置</div><div>                        1.1）pip install --upgrade pip &amp;&amp;  pip install awscli requests pytest boto3 logger</div><div>                        1.2）get samtools</div><div>                        1.3)  get bwa </div><div>                        1.4)  get sambamba </div><div>                        1.5)  get bedtools</div><div>                        1.6)  get diamond        （ <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">Fast and sensitive protein alignment using DIAMOND</span>）（<a href="https://github.com/bbuchfink/diamond">https://github.com/bbuchfink/diamond</a>）</div><div>                        1.7）R包安装</div><div style="margin-left: 120px;">install.packages(&quot;devtools&quot;, repos=&quot;<a href="http://cran.r-project.org/">http://cran.r-project.org</a>&quot;, clean=TRUE)</div><div style="margin-left: 120px;">devtools::install_version(&quot;data.table&quot;, &quot;1.9.6&quot;, repos=&quot;<a href="http://cran.r-project.org/">http://cran.r-project.org</a>&quot;, clean=TRUE)</div><div style="margin-left: 120px;">devtools::install_version(&quot;lpSolve&quot;, &quot;5.6.13&quot;, repos=&quot;<a href="http://cran.r-project.org/">http://cran.r-project.org</a>&quot;, clean=TRUE)</div><div style="margin-left: 120px;">source(&quot;<a href="http://bioconductor.org/biocLite.R">http://bioconductor.org/biocLite.R&quot;);</a> biocLite(&quot;IRanges&quot;, ask = F, suppressUpdates = T, suppressAutoUpdate = T)</div><div>                        下载地址：</div><div>                            <a href="https://github.com/samtools/samtools/releases/download/1.3/samtools-1.3.tar.bz2">https://github.com/samtools/samtools/releases/download/1.3/samtools-1.3.tar.bz2</a></div><div>                            <a href="http://downloads.sourceforge.net/project/bio-bwa/bwa-0.7.15.tar.bz2">http://downloads.sourceforge.net/project/bio-bwa/bwa-0.7.15.tar.bz2</a></div><div>                            <a href="https://github.com/lomereiter/sambamba/releases/download/v0.6.6/sambamba_v0.6.6_linux.tar.bz2">https://github.com/lomereiter/sambamba/releases/download/v0.6.6/sambamba_v0.6.6_linux.tar.bz2</a></div><div>                            <a href="https://github.com/arq5x/bedtools2/releases/download/v2.26.0/bedtools-2.26.0.tar.gz">https://github.com/arq5x/bedtools2/releases/download/v2.26.0/bedtools-2.26.0.tar.gz</a></div><div>                            <a href="https://github.com/bbuchfink/diamond/releases/download/v0.8.15/diamond-linux64.tar.gz">https://github.com/bbuchfink/diamond/releases/download/v0.8.15/diamond-linux64.tar.gz</a></div><div>                    2) </div><div><br/></div><div><br/></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 10pt; color: rgb(36, 41, 46); font-family: &quot;Times New Roman&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">        </span></span></div><div><br/></div><div><br/></div></span>
</div></body></html> 