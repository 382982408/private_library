<html>
<head>
  <title>WGS_WES_pip.SOP 测试</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="775"/>
<h1>WGS_WES_pip.SOP 测试</h1>

<div>
<span><div>WGS_WES_pip.SOP 测试</div><div>git地址：<a href="http://10.0.1.7:9527/lijun1/wgs.pip/blob/master/WGS_WES_pip.SOP.md">http://10.0.1.7:9527/lijun1/wgs.pip/blob/master/WGS_WES_pip.SOP.md</a></div><div>测试目录：/mnt/X500/farmers/luozw/factory/20190805_WGS_WES_pip_test/20190816_bwa2bam</div><div><br/></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0);">1）fastq指控</span></div><div><span style="color: rgb(255, 0, 0);"> 数据信息详解：</span>  /mnt/GenePlus001/archive/2019/05/01/V300018618_L002/190501_Q100020010_V300018618_L002_199003846BD_HUM_N_GC1A_525_Z_0_A/190501_Q100020010_V300018618_L002_199003846BD_HUM_N_GC1A_525_Z_0_A_1.fq.gz</div><div>        <span style="color: rgb(255, 70, 53);">1.1）所有数据存档目录：</span><span style="color: rgb(255, 70, 53);">/mnt/GenePlus001/archive/ +上机时间+FC号+（日期+上级类型+FC号+lane号+</span><span style="color: rgb(255, 70, 53);">子文库名称</span><span style="color: rgb(255, 70, 53);">）/ </span><span style="color: rgb(255, 70, 53);">（日期+上级类型+FC号+lane号+</span><span style="color: rgb(255, 70, 53);">子文库名称</span><span style="color: rgb(255, 70, 53);">）+</span><span style="color: rgb(255, 70, 53);">_1.fq.gz</span></div><div><span style="color: rgb(227, 0, 0);">                上机时间           2019/05/01</span></div><div><span style="color: rgb(227, 0, 0);">                 FC号                V300018618</span></div><div><span style="color: rgb(227, 0, 0);">                日期                 190501</span></div><div><span style="color: rgb(227, 0, 0);">                上级类型           Q100020010</span></div><div><span style="color: rgb(227, 0, 0);">                FC 号                V300018618</span></div><div><span style="color: rgb(227, 0, 0);">                </span> <span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(227, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">lane号             </span><span style="color: rgb(227, 0, 0);">L002 </span></div><div><span style="color: rgb(227, 0, 0);">                子文库名称       199003846BD_HUM_N_GC1A_525_Z_0_A</span></div><div><span style="color: rgb(227, 0, 0);"><span>    </span><span>    </span><span>    </span><span>    </span></span> <span style="color: rgb(25, 31, 37); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif, Tahoma, &quot;Segoe UI Symbol&quot;; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(201, 231, 255);">echo 199003847TD_HUM_C_GC1A_532_Z_0_A_190501_Q100020010_V300018618_L004_1.fq.gz |sed -e 's/_/\t/8' -e 's/_/\t/1' -e 's/_[12].fq.gz//g'</span></div><div><span style="color: rgb(25, 31, 37); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif, Tahoma, &quot;Segoe UI Symbol&quot;; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(201, 231, 255);"><span>    </span><span>    </span><span>    </span><span>    </span>这三个分别就是 SM LB PU</span></div><div>        1.2）根据下机表中的FC名称和数据下机时间找到FC所有fq-data数据的存放目录。</div><div>                awk 'NR&gt;1{print $2,$NF}' sq.xls | sort | uniq |sed 's#/#/0#g' | while read a b;do ls /mnt/GenePlus001/archive/$a/$b*;done &gt; f.1</div><div>                grep ':' f.1 | sed 's/://' | while read l;do find $l -name &quot;*_1.fq.gz&quot;;done |grep -v 'cutadpt' &gt; f.2</div><div>                awk 'NR&gt;1{print $8}' sq.xls | sort | uniq &gt; lib.lst</div><div>                cat lib.lst | while read l;do grep $l f.2;done &gt; f.3</div><div>        1.3）新建fastq目录，把下机fastq文件链接到此目录</div><div>                awk -F '/' '{print $(NF-1),$0}' f.3 | sed 's/_/ /4;s/_1.fq.gz//' | awk '{print &quot;ln -s &quot;$NF&quot;_1.fq.gz &quot;$2&quot;_&quot;$1&quot;_1.fq.gz&quot;;print &quot;ln -s &quot;$NF&quot;_2.fq.gz &quot;$2&quot;_&quot;$1&quot;_2.fq.gz&quot;}' &gt; fq.lnk</div><div>                awk -F '/' '{print $(NF-1),$0}' f.3 | sed 's/_/ /4;s/_1.fq.gz//' |awk '{print $2,$1}' | sed 's/_/ /' &gt; cfg.all</div><div>                sh fq.lnk</div><div>        1.4）把clean data的qc结果整理过来</div><div>                cat ../00.prepare/f.3 | while read l;do pa=`dirname $l`;ls $pa/Basic_Statistics_of_Sequencing_Quality.txt;done &gt;  fq.st.lst</div><div>                awk -F '/' '{print $(NF-1),$0}' fq.st.lst | while read a b;do awk -F &quot;\t&quot; -v n=$a 'NR&gt;1&amp;&amp;NF&gt;3{print $0&quot;\t&quot;n}' $b;done &gt; all.1</div><div>                awk -F '_' '{print $0&quot;\t&quot;$5}' all.1 &gt; all.2</div><div><span style="font-size: 16pt; color: rgb(255, 0, 0);">2)  比对生成bam文件</span></div><div>            2.1）生成比对脚本    </div><div>            示例：cat mp.199003858BD.sh：</div><div>                                /repos/lijun/pip/mp/sentieon/MP4Sentieon cfg.199003858BD 199003858BD /mnt/X500/farmers/lijun/prj/BZSG/WGS/fq</div><div><br/></div><div>                          <img src="WGS_WES_pip.SOP 测试_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>                2.2）任务投递：</div><div>                        按内存25G，cpu数为32个进行qsub</div><div>                        qsub -cwd -l vf=25g -l num_proc=32 mp.xx.sh</div><div><span style="font-size: 14pt; color: rgb(227, 0, 0);">3）SNV calling</span></div><div>                我们使用gatk4.1.2.0+Mutect2进行配对样本SNV检测。</div><div>        3.1）生成各自对应的bam文件信息，并进行检查。</div><div>            格式：tumorname normalname tumorbam normalbam</div><div>            head s1.lst</div><div>            199003847TD 199003848BD ./recaled.bam ./recaled.bam</div><div>        3.2) 根据3.1生成所有配对样本的calling任务脚本</div><div>            cat s1.lst | while read a b c d;do sh /repos/lijun/pip/m2/gm  ${a}_$b $b $c $d &gt; m2.${a}_$b.sh;done</div><div>            /mnt/X500/farmers/lijun/an/pip/m2/gm</div><div>            <img src="WGS_WES_pip.SOP 测试_files/Image [1].png" type="image/png" data-filename="Image.png" width="541"/></div><div>            •【gm.wgs】WGS 高深度样本因为计算时间较长，需要将基因组切分以提高效率。<span style="color: rgb(227, 0, 0);">当深度大于30X请采用以下模块进行分析。</span>使用参数不变，已内置切分基因组的区间。</div><div>            <img src="WGS_WES_pip.SOP 测试_files/Image [2].png" type="image/png" data-filename="Image.png" width="565"/></div><div>        3.3) 任务投递。</div><div><span style="font-size: 14pt; color: rgb(255, 0, 0);"> 4) VEP注释</span></div><div>        4.1）生成VCF配置文件</div><div>                cat /mnt/X500/farmers/yangzq/Pipeline/VEP_Anno/sample.vcf.list 格式：</div><div>                    tumorname normalname vcf</div><div>                    199003847TD 199003846BD /mnt/X500/farmers/yangzq/Project/BS2019040901-PMME-WGS/01.somatic/SNV/199003847TD_199003846BD.somatic.vcf</div><div>        4.2）生成VEP注释脚本 输入VCF配置文件及脚本输出目录，任务投递。 生成脚本：</div><div>                perl /mnt/X500/farmers/yangzq/Pipeline/VEP_Anno/VEP_Anno.pl  sample.vcf.list workshell_dir</div><div>        4.3)任务投递。</div><div><br/></div><div><span style="color: rgb(255, 0, 0);">        另外：vcf2maf 工具了解一下：</span><a href="https://github.com/mskcc/vcf2maf" style="color: rgb(255, 0, 0);">https://github.com/mskcc/vcf2maf</a></div><div><br/></div><div><span style="font-size: 16pt; color: rgb(227, 0, 0);">5)临床注释</span></div><div><font color="#FF0000" style="font-size: 16pt;"><br/></font></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0);">6)WGS SV 分析</span></div><div>        git-lab地址：<a href="http://10.0.1.7:9527/linhx/WGS_SV_pipeline">http://10.0.1.7:9527/linhx/WGS_SV_pipeline</a></div><div><span style="color: rgb(70, 70, 70);">        git-hub地址好像和这个不是同一个，垃圾地址：</span><a href="https://github.com/luoshizhi/MeerkatSV" style="color: rgb(70, 70, 70);">https://github.com/luoshizhi/MeerkatSV</a></div><div><br/></div><div>        1）python /mnt/X500/farmers/linhx/bin/software/Meerkat/main_pipe.py tumor_bam normal_bam SV_result_dir &gt; ./work.sh 。</div><div>        2)  投递work.sh任务。</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 