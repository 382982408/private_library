<html>
<head>
  <title>k-mer分析工具之JELLYFISH：</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1415"/>
<h1>k-mer分析工具之JELLYFISH：</h1>

<div>
<span><div><font style="font-size: 16pt;"><span style="word-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 16pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;, serif; font-variant-caps: normal; font-variant-ligatures: normal;">k-mer</span><span style="word-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 16pt; color: rgb(255, 0, 0); font-family: 宋体; font-variant-caps: normal; font-variant-ligatures: normal;">分析工具之</span><span style="word-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 16pt; color: rgb(255, 0, 0); font-family: &quot;Times New Roman&quot;, serif; font-variant-caps: normal; font-variant-ligatures: normal;">JELLYFISH：</span></font></div><div><span style="word-wrap: break-word; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="word-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(0, 0, 0); font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">1）软件安装：</span></font></span></div><div><span style="word-wrap: break-word; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;, serif; font-variant-caps: normal; font-variant-ligatures: normal;">        官网地址：</span><span style="font-size: 11pt;"><a href="http://www.cbcb.umd.edu/software/jellyfish/" style="font-size: 11pt; font-family: &quot;Times New Roman&quot;;">http://www.cbcb.umd.edu/software/jellyfish/</a></span></div><div>        github地址：<a href="https://github.com/gmarcais/Jellyfish/releases">https://github.com/gmarcais/Jellyfish/releases</a> </div><div><font style="color: rgb(255, 0, 0);"><b>        conda安装：conda install jellyfish</b></font></div><div>        详细教程：<a href="https://www.cnblogs.com/zhanmaomao/p/9285582.html">https://www.cnblogs.com/zhanmaomao/p/9285582.html</a></div><div><a href="https://mp.weixin.qq.com/s?__biz=MzIwODA1MzI4Mg%3D%3D&amp;chksm=809fedc3b7e864d5fc4769def31771bd7b3971030a330bde709c955f74bc1f028be7aeb360e4&amp;idx=1&amp;mid=2456008846&amp;scene=21&amp;sn=06c1bb356fbe9330e4ff8a2abb920188">https://mp.weixin.qq.com/s?__biz=MzIwODA1MzI4Mg%3D%3D&amp;chksm=809fedc3b7e864d5fc4769def31771bd7b3971030a330bde709c955f74bc1f028be7aeb360e4&amp;idx=1&amp;mid=2456008846&amp;scene=21&amp;sn=06c1bb356fbe9330e4ff8a2abb920188</a></div><div>         <span style="font-size: 17px; letter-spacing: 0.544px; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">jellyfish有两个大版本，1.0版本和2.0版本；</span><span style="font-size: 17px; letter-spacing: 0.544px;"><span style="font-size: 17px; color: rgb(255, 0, 0); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">1.0版本最多支持kmer长度为31</span></span><span style="font-size: 17px; letter-spacing: 0.544px; color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">；</span><span style="font-size: 17px; letter-spacing: 0.544px;"><span style="font-size: 17px; color: rgb(255, 70, 53); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">2.0版本对kmer长度没有任何的限制</span></span><span style="font-size: 17px; letter-spacing: 0.544px; color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">。在下载时，注意下载2.0版本。</span></div><div><span style="font-size: 17px; letter-spacing: 0.544px; color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">      遇到问题：1）直接下载安装好的2.0软件    -&gt;    内核太老，无法运行</span></div><div><span style="font-size: 17px; letter-spacing: 0.544px; color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">                           </span><span style="font-size: 17px; letter-spacing: 0.544px; color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">直接下载安装好的1.0软件</span><span style="font-size: 17px; letter-spacing: 0.544px; color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">    -&gt;</span><span style="font-size: 17px; letter-spacing: 0.544px; color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">    </span><span style="font-size: 17px; letter-spacing: 0.544px; color: rgb(255, 0, 0); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">kmer长度顶多为31，太短了</span></div><div><span style="font-size: 17px; letter-spacing: 0.544px; font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><span style="font-size: 17px; font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; color: rgb(255, 0, 0);">    </span><span style="font-size: 17px; font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; color: rgb(255, 0, 0);">    </span><span style="font-size: 17px; font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; color: rgb(255, 0, 0);">    </span><span style="font-size: 17px; font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; color: rgb(255, 0, 0);">    </span><span style="font-size: 17px; font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; color: rgb(255, 0, 0);">    </span><span style="font-size: 17px; font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; color: rgb(255, 0, 0);">  </span>     下载</span><span style="font-size: 17px; letter-spacing: 0.544px; font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">2.0source 安装    -&gt;    <span style="font-size: 17px; font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; color: rgb(51, 51, 51);"> </span></span></div><div>                                            tar -zxvf jellyfish-2.2.10.tar.gz</div><div>                                            cd jellyfish-2.2.10 &amp;&amp; chmod +x configure</div><div>                                            mkdir -p /mnt/X500/farmers/luozw/bin/jellyfish/</div><div>                                            ./configure --prefix=/mnt/X500/farmers/luozw/bin/jellyfish/</div><div>                                            make -j 8 &amp;&amp; make install</div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">2）命令详解：</span></font></div><div>        1. count -&gt; 用来计算kmer分布，用法如下</div><div>            jellyfish count -m 31 -t 10 -s 1G test.fq</div><div>            -m参数指定kmer的长度，</div><div>            -t指定并行的线程数，</div><div>            -s指定内存中hash的大小，这个参数可以根据基因组的大小适当调整，比如人类基因组3G,这里就设置成3G;</div><div>            -o | --output=&lt;string&gt;  default: mer_counts    输出的结果文件前缀</div><div>            -L | --lower-count=&lt;num&gt;        不输出数目低于此值的k-mer</div><div>            -U | --upper-count=&lt;num&gt;        不输出数目高于此值的k-mer</div><div>            test.fq是输入的序列文件。</div><div>            需要注意的是，jellysifh 只能接受fastq或者fasta文件作为输入，而且不能是压缩文件。</div><div>            默认情况下会生成名为mer_counts.jf的文件，该文件是一个二进制文件，可以通过其他命令来查看该文件中的内容。</div><div>        2. merge 融合二进制的输出结果</div><div>            上一步的输出结果为二进制文件，可能输出了多个hash文件，因此需要将这些hash文件合并成一个文件，此时用到 merge 命令。使用方法：</div><div>            jellyfish merge -o mer_counts_merged.jf hash1 hash2 ...</div><div>            常用参数：    </div><div>            -o | --output=&lt;string&gt;  default: mer_counts_merged.jf    输出的结果文件    </div><div>            --out-counter-len=&lt;num&gt;  default: 4    输出的二进制hash文件中的计数结果所占的字节数,一个字节是8比特。则默认支持的最大数字是2^32=4.3G    </div><div>            </div><div>        3. dump子命令可以将上述步骤生成的二进制文件转换成纯文本的文件，用法如下</div><div>            -c | --colum  default: false        生成结果为2列，第一列为k-mer序列，第二列为对应的数目。默认情况下是是fasta格式，fasta的头为k-mer的数目，fasta的序列为k-mer的序列。</div><div>            -t | --tab  default: false        当 -c 参数存在时，以tab来进行分隔两行。默认是以空格来分开的。</div><div>            -L | --lower-count=&lt;num&gt;        不输出小于该值的k-mer</div><div>            -U | --upper-count=&lt;num&gt;        不输出高于该值的k-mer</div><div>            -o | --output=&lt;file&gt;        输出文件的路径和名称</div><div>            2.1)jellyfish dump mer_counts.jf &gt; kmer_count.fasta</div><div>            kmer_count.fasta文件中每一条序列就是一个kmer,序列标识符是该kmer出现的次数，示意如下:</div><div>                &gt;1150</div><div>                AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</div><div>                &gt;20</div><div>                GCTACCATGATAGCCAAGGAAATCCCACAAA</div><div>                也支持输出成表格的形式，只需要添加-c和-t两个参数，用法如下</div><div>            2.2)jellyfish dump  -c -t mer_counts.jf &gt; kmer_count.tsv</div><div>            输出内容如下</div><div>                AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 1150</div><div>                GCTACCATGATAGCCAAGGAAATCCCACAAA 20</div><div>                TATTTGCGGAGCTTGTTAGATAACAATCAAA 18</div><div>                第一列为kmer,第二列为该kmer频数。</div><div>        4. query 子命令可以快速查询某个kmer的频数，用法如下</div><div>            jellyfish query mer_counts.jf GCTACCATGATAGCCAAGGAAATCCCACAAA</div><div>            -C | --both-strands  default: false        同时查询k-mer序列的正负链</div><div>            -i | --input=&lt;file&gt;        输入的文件</div><div>            -o | --output=&lt;file&gt;        输出的文件</div><div>            输出结果：</div><div>                GCTACCATGATAGCCAAGGAAATCCCACAAA 20</div><div>        5. stats子命令会给出kmer的基本统计信息，用法如下</div><div>            jellyfish stats mer_counts.jf</div><div>            -L | --lower-count=&lt;num&gt;        不统计数目低于此值的k-mer</div><div>            -U | --upper-count=&lt;num&gt;        不统计数目高于此值的k-mer</div><div>            会在命令行输出如下统计结果</div><div>                Unique:    130512636</div><div>                Distinct:  260032104</div><div>                Total:     3502352808</div><div>                Max_count: 43395</div><div>                unique 代表只出现了1次的kmer个数；Distinct 代表kmer的个数，Total 代表所有kmer频数总和，Max count 代表kmer的最大频数。</div><div>        6. histo子命令统计kmer的频数分布，用法如下</div><div>            jellyfish histo mer_counts.jf &gt; kmer_hist.tsv</div><div>            输出内容如下    </div><div>                1 130512636</div><div>                2 24879103</div><div>                3 12766220</div><div>                4 8746042</div><div>            第一列代表kmer的频数，第二列代表出现该频数的kmer的总数。利用这个数据，可以画出kmer频数分布曲线，对应的R语言代码如下</div><div>            x &lt;- read.table(input, header = F, sep = &quot; &quot;, stringsAsFactors = F)</div><div>            pdf(&quot;kmer_hist.pdf&quot;)</div><div>            plot(x, type = &quot;l&quot;)</div><div>            dev.off()</div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">3）为什么要进行Kmer 分析？</span></font></div><div><a href="http://blog.sciencenet.cn/blog-3406804-1162384.html">http://blog.sciencenet.cn/blog-3406804-1162384.html</a></div></span>
</div></body></html> 