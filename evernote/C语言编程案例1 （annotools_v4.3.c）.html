<html>
<head>
  <title>C语言编程案例1 （annotools_v4.3.c）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="400"/>
<h1>C语言编程案例1 （annotools_v4.3.c）</h1>

<div>
<span><div><span style="font-size: 12pt; color: rgb(255, 0, 0);">C语言编程案例1 （</span><span style="font-size: 12pt; color: rgb(255, 0, 0);">annotools_v4.3.c</span><span style="font-size: 12pt; color: rgb(255, 0, 0);">）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">#include &lt;stdio.h&gt;</span></div><div><span style="font-size: 12pt;">#include &lt;math.h&gt;</span></div><div><span style="font-size: 12pt;">#include &lt;string.h&gt;</span></div><div><span style="font-size: 12pt;">#include &lt;malloc.h&gt;</span></div><div><span style="font-size: 12pt;">#include &lt;stdlib.h&gt;</span></div><div><span style="font-size: 12pt;">#include &lt;zlib.h&gt;</span></div><div><span style="font-size: 12pt;">#include &lt;unistd.h&gt;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">#define H_num 10</span></div><div><span style="font-size: 12pt;">#define LEN_1 500;</span></div><div><span style="font-size: 12pt;">#define LEN_2 200;</span></div><div><span style="font-size: 12pt;">#define LEN_3 100;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">int main(int argc, char *argv[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    int get_check(char d[]);</span></div><div><span style="font-size: 12pt;">    int get_index(char d[]);</span></div><div><span style="font-size: 12pt;">    int get_sort(char i[],char o[]);</span></div><div><span style="font-size: 12pt;">    //////////////</span></div><div><span style="font-size: 12pt;">    int get_filter(char i[],char o[],char d[]);</span></div><div><span style="font-size: 12pt;">    int get_db_combine(char i[],char o[],char d[],char n[]);</span></div><div><span style="font-size: 12pt;">    int get_crush(char d[],char o[],char n[]);</span></div><div><span style="font-size: 12pt;">    //////////////</span></div><div><span style="font-size: 12pt;">    int get_anno(char i[],char o[],char d[]);</span></div><div><span style="font-size: 12pt;">    int get_intersect(char i[],char o[],char d[],char n[]);</span></div><div><span style="font-size: 12pt;">    int help(char prog[],char cmd[],char i[],char o[],char d[],char n[]);</span></div><div><span style="font-size: 12pt;">    ////////////////////////</span></div><div><span style="font-size: 12pt;">    char opt_cmd[100];opt_cmd[0]='\0';</span></div><div><span style="font-size: 12pt;">    char opt_i[500];opt_i[0]='\0';</span></div><div><span style="font-size: 12pt;">    char opt_o[500];opt_o[0]='\0';</span></div><div><span style="font-size: 12pt;">    char opt_d[500];opt_d[0]='\0';</span></div><div><span style="font-size: 12pt;">    char opt_n[500];opt_n[0]='\0';</span></div><div><span style="font-size: 12pt;">    ////////////////////////</span></div><div><span style="font-size: 12pt;">    if (argv[1]!=NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        sscanf(argv[1],&quot;%s&quot;,&amp;opt_cmd);</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    int opt;</span></div><div><span style="font-size: 12pt;">    while ((opt=getopt(argc,argv,&quot;i:d:o:n:&quot;))!=-1)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        switch(opt)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            case 'i':</span></div><div><span style="font-size: 12pt;">                sscanf(optarg,&quot;%s&quot;,&amp;opt_i);</span></div><div><span style="font-size: 12pt;">                break;</span></div><div><span style="font-size: 12pt;">            case 'd':</span></div><div><span style="font-size: 12pt;">                sscanf(optarg,&quot;%s&quot;,&amp;opt_d);</span></div><div><span style="font-size: 12pt;">                break;</span></div><div><span style="font-size: 12pt;">            case 'o':</span></div><div><span style="font-size: 12pt;">                sscanf(optarg,&quot;%s&quot;,&amp;opt_o);</span></div><div><span style="font-size: 12pt;">                break;</span></div><div><span style="font-size: 12pt;">            case 'n':</span></div><div><span style="font-size: 12pt;">                sscanf(optarg,&quot;%s&quot;,&amp;opt_n);</span></div><div><span style="font-size: 12pt;">                break;</span></div><div><span style="font-size: 12pt;">            default:</span></div><div><span style="font-size: 12pt;">                break;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    help(argv[0],opt_cmd,opt_i,opt_o,opt_d,opt_n);</span></div><div><span style="font-size: 12pt;">//    printf(&quot;\nwork done ...\n\n&quot;);</span></div><div><span style="font-size: 12pt;">    return 0;</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;">////////////////////////////////</span></div><div><span style="font-size: 12pt;">int get_intersect(char i[],char o[],char d[],char n[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    printf(&quot;start to intersect...\n\n&quot;);</span></div><div><span style="font-size: 12pt;">    ////////</span></div><div><span style="font-size: 12pt;">    char idx_chr[20];</span></div><div><span style="font-size: 12pt;">    sscanf(&quot;NC_000001.10&quot;,&quot;%s&quot;,&amp;idx_chr);</span></div><div><span style="font-size: 12pt;">    long idx_start=0;</span></div><div><span style="font-size: 12pt;">    long idx_end=0;</span></div><div><span style="font-size: 12pt;">    float idx_seek=0;</span></div><div><span style="font-size: 12pt;">    float idx_diff=5000;</span></div><div><span style="font-size: 12pt;">    float seek_tmp=0;</span></div><div><span style="font-size: 12pt;">    ////////////</span></div><div><span style="font-size: 12pt;">    int idx_tag=1;</span></div><div><span style="font-size: 12pt;">    float seek_down=0;</span></div><div><span style="font-size: 12pt;">    //////////////////////</span></div><div><span style="font-size: 12pt;">    FILE *IN,*ON,*IDX,*OUT;</span></div><div><span style="font-size: 12pt;">    char file_idx[500];</span></div><div><span style="font-size: 12pt;">    sprintf(file_idx,&quot;%s.idx&quot;,d);</span></div><div><span style="font-size: 12pt;">    IN=fopen(i,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    ON=fopen(d,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    OUT=fopen(o,&quot;w&quot;);</span></div><div><span style="font-size: 12pt;">    IDX=fopen(file_idx,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    if (IN==NULL || ON==NULL || IDX==NULL || OUT==NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        printf(&quot;Attention:\tmust be something wrong in this files, please check them !\n&quot;);</span></div><div><span style="font-size: 12pt;">        return 0;</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    //////////////////</span></div><div><span style="font-size: 12pt;">    char report[5000];</span></div><div><span style="font-size: 12pt;">    char LINE_IN[50000];</span></div><div><span style="font-size: 12pt;">    char LINE_ON[50000];</span></div><div><span style="font-size: 12pt;">    char LINE_IDX[500];</span></div><div><span style="font-size: 12pt;">    char check='N';</span></div><div><span style="font-size: 12pt;">    fgets(LINE_IDX,sizeof(LINE_IDX),IDX);</span></div><div><span style="font-size: 12pt;">    LINE_IDX[strlen(LINE_IDX)-1]=' ';</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    while(fgets(LINE_IN,sizeof(LINE_IN),IN)!=NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strstr(LINE_IN,&quot;####&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        }else if (strstr(LINE_IN,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        //////////</span></div><div><span style="font-size: 12pt;">        char chr[20];</span></div><div><span style="font-size: 12pt;">        long start=0;</span></div><div><span style="font-size: 12pt;">        long end=0;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        sscanf(LINE_IN,&quot;%s%d%d&quot;,&amp;chr,&amp;start,&amp;end);</span></div><div><span style="font-size: 12pt;">        if (strstr(chr,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (strlen(LINE_IN)&gt;=4998)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        ///////////////////</span></div><div><span style="font-size: 12pt;">//        printf(&quot;AAA\t%s\t%0.f\t%s\n&quot;,LINE_IN,seek_down,chr);</span></div><div><span style="font-size: 12pt;">        while (idx_tag==1 &amp;&amp; (strcmp(chr,idx_chr)&gt;0 || (strcmp(chr,idx_chr)==0 &amp;&amp; start&gt;idx_end)))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            if (idx_seek &gt; seek_down)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                seek_down=idx_seek;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            if (fgets(LINE_IDX,sizeof(LINE_IDX),IDX)!=NULL)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                LINE_IDX[strlen(LINE_IDX)-1]=' ';</span></div><div><span style="font-size: 12pt;">                sscanf(LINE_IDX,&quot;%s%d%d%f&quot;,&amp;idx_chr,&amp;idx_start,&amp;idx_end,&amp;idx_seek);</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                idx_tag=0;</span></div><div><span style="font-size: 12pt;">                break;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            fseek(ON,seek_down,SEEK_SET);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        //////////////////////</span></div><div><span style="font-size: 12pt;">        float seek_true=ftell(ON);</span></div><div><span style="font-size: 12pt;">        seek_true=seek_true-idx_diff;</span></div><div><span style="font-size: 12pt;">        if(seek_true&lt;0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">                seek_true=0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        fseek(ON,seek_true,SEEK_SET);</span></div><div><span style="font-size: 12pt;">        //////////////////////</span></div><div><span style="font-size: 12pt;">        int report_tag=0;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">//        printf(&quot;AAA\t%s\t%0.f\t%s\n&quot;,LINE_IN,seek_down,chr);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        while(fgets(LINE_ON,sizeof(LINE_ON),ON)!=NULL)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            char chr_2[20];</span></div><div><span style="font-size: 12pt;">            long start_2=0;</span></div><div><span style="font-size: 12pt;">            long end_2=0;</span></div><div><span style="font-size: 12pt;">            //////////////////////</span></div><div><span style="font-size: 12pt;">            if (strstr(LINE_ON,&quot;NC_0000&quot;) &amp;&amp; (LINE_ON[0]=='N'))</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            sscanf(LINE_ON,&quot;%s%d%d&quot;,&amp;chr_2,&amp;start_2,&amp;end_2);</span></div><div><span style="font-size: 12pt;">            if (strstr(chr_2,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            if (strlen(LINE_ON)&gt;=4998)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            //////////////////////</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">//            printf(&quot;BBB\t%s\t%f\t%f\n&quot;,LINE_ON,seek_down,seek_tmp);</span></div><div><span style="font-size: 12pt;">                if (strcmp(chr,chr_2) &lt; 0)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    break;</span></div><div><span style="font-size: 12pt;">                }else if(strcmp(chr,chr_2) &gt; 0)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    continue;</span></div><div><span style="font-size: 12pt;">                }else</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">//                    printf(&quot;BBB\t%s\t%f\t%f\n&quot;,LINE_ON,seek_down,seek_tmp);</span></div><div><span style="font-size: 12pt;">                    if (end &lt; start_2)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        if (report_tag==1)</span></div><div><span style="font-size: 12pt;">                        {</span></div><div><span style="font-size: 12pt;">                            fseek(ON,seek_tmp,SEEK_SET);</span></div><div><span style="font-size: 12pt;">                        };</span></div><div><span style="font-size: 12pt;">                        break;</span></div><div><span style="font-size: 12pt;">                    }else if (start &gt; end_2)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        continue;</span></div><div><span style="font-size: 12pt;">                    }else</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        if (report_tag==0)</span></div><div><span style="font-size: 12pt;">                        {</span></div><div><span style="font-size: 12pt;">                            sprintf(report,&quot;%s\t####%s\t%s&quot;,LINE_IN,n,LINE_ON);</span></div><div><span style="font-size: 12pt;">                            fputs(report,OUT);</span></div><div><span style="font-size: 12pt;">                            report_tag=1;</span></div><div><span style="font-size: 12pt;">                            seek_tmp=ftell(ON);</span></div><div><span style="font-size: 12pt;">                        }else</span></div><div><span style="font-size: 12pt;">                        {</span></div><div><span style="font-size: 12pt;">                            sprintf(report,&quot;\t####%s\t%s&quot;,n,LINE_ON);</span></div><div><span style="font-size: 12pt;">                            fputs(report,OUT);</span></div><div><span style="font-size: 12pt;">                        };</span></div><div><span style="font-size: 12pt;">                    };</span></div><div><span style="font-size: 12pt;">                };</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        //////////////</span></div><div><span style="font-size: 12pt;">        if (report_tag==0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    printf(&quot;intersecting is ended...\n&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    fclose (IN);</span></div><div><span style="font-size: 12pt;">    fclose (ON);</span></div><div><span style="font-size: 12pt;">    fclose (IDX);</span></div><div><span style="font-size: 12pt;">    fclose (OUT);</span></div><div><span style="font-size: 12pt;">    return 0;</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;">////////////////////////////////</span></div><div><span style="font-size: 12pt;">////////////////////////////////</span></div><div><span style="font-size: 12pt;">int get_filter(char i[],char o[],char d[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    printf(&quot;start to filter...\n\n&quot;);</span></div><div><span style="font-size: 12pt;">    //////////////////////</span></div><div><span style="font-size: 12pt;">    float idx_diff=5000;</span></div><div><span style="font-size: 12pt;">    FILE *IN,*ON,*OUT,*ERR;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    IN=fopen(d,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    ON=fopen(i,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    OUT=fopen(o,&quot;w&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    char o_err[500];</span></div><div><span style="font-size: 12pt;">    sprintf(o_err,&quot;%s.err&quot;,o);</span></div><div><span style="font-size: 12pt;">    ERR=fopen(o_err,&quot;w&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    if (IN==NULL || ON==NULL || OUT==NULL || ERR==NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        printf(&quot;Attention:\tmust be something wrong in this files, please check them !\n&quot;);</span></div><div><span style="font-size: 12pt;">        return 0;</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    //////////////////</span></div><div><span style="font-size: 12pt;">    char report[5000];</span></div><div><span style="font-size: 12pt;">    char LINE_IN[5000];</span></div><div><span style="font-size: 12pt;">    char LINE_ON[5000];</span></div><div><span style="font-size: 12pt;">    while(fgets(LINE_IN,sizeof(LINE_IN),IN)!=NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        char chr[20];</span></div><div><span style="font-size: 12pt;">        long start=0;</span></div><div><span style="font-size: 12pt;">        long end=0;</span></div><div><span style="font-size: 12pt;">        if (strstr(LINE_IN,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            sprintf(report,&quot;error:not_begin_with_NC\t%s&quot;,LINE_IN);</span></div><div><span style="font-size: 12pt;">            fputs(report,ERR);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        //////////</span></div><div><span style="font-size: 12pt;">        sscanf(LINE_IN,&quot;%s%d%d&quot;,&amp;chr,&amp;start,&amp;end);</span></div><div><span style="font-size: 12pt;">        if (strstr(chr,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            sprintf(report,&quot;error:not_begin_with_NC\t%s&quot;,LINE_IN);</span></div><div><span style="font-size: 12pt;">            fputs(report,ERR);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (strlen(LINE_IN)&gt;=4998)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            sprintf(report,&quot;error:data_too_long\t%s&quot;,LINE_IN);</span></div><div><span style="font-size: 12pt;">            fputs(report,ERR);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        ///////////////////</span></div><div><span style="font-size: 12pt;">//        printf(&quot;AAA\t%s\t%0.f\t%s\n&quot;,LINE_IN,seek_down,chr);</span></div><div><span style="font-size: 12pt;">        //////////////////////</span></div><div><span style="font-size: 12pt;">        float seek_true=ftell(ON);</span></div><div><span style="font-size: 12pt;">        seek_true=seek_true-idx_diff;</span></div><div><span style="font-size: 12pt;">        if(seek_true&lt;0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">                seek_true=0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        fseek(ON,seek_true,SEEK_SET);</span></div><div><span style="font-size: 12pt;">        //////////////////////</span></div><div><span style="font-size: 12pt;">        int report_tag=0;</span></div><div><span style="font-size: 12pt;">        //////////////////////</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        while(fgets(LINE_ON,sizeof(LINE_ON),ON)!=NULL)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            char chr_2[20];</span></div><div><span style="font-size: 12pt;">            long start_2=0;</span></div><div><span style="font-size: 12pt;">            long end_2=0;</span></div><div><span style="font-size: 12pt;">            //////////////////////</span></div><div><span style="font-size: 12pt;">            if (strstr(LINE_ON,&quot;NC_0000&quot;) &amp;&amp; (LINE_ON[0]=='N'))</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            sscanf(LINE_ON,&quot;%s%d%d&quot;,&amp;chr_2,&amp;start_2,&amp;end_2);</span></div><div><span style="font-size: 12pt;">            if (strstr(chr_2,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            if (strlen(LINE_ON)&gt;=4998)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            //////////////////////</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">//            printf(&quot;BBB\t%s\t%f\t%f\n&quot;,LINE_ON,seek_down,seek_tmp);</span></div><div><span style="font-size: 12pt;">                if (strcmp(chr,chr_2) &lt; 0)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    break;</span></div><div><span style="font-size: 12pt;">                }else if(strcmp(chr,chr_2) &gt; 0)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    continue;</span></div><div><span style="font-size: 12pt;">                }else</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">//                    printf(&quot;BBB\t%s\t%f\t%f\n&quot;,LINE_ON,seek_down,seek_tmp);</span></div><div><span style="font-size: 12pt;">                    if (end &lt; start_2)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        break;</span></div><div><span style="font-size: 12pt;">                    }else if (start &gt; end_2)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        continue;</span></div><div><span style="font-size: 12pt;">                    }else</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        report_tag=1;</span></div><div><span style="font-size: 12pt;">                        break;</span></div><div><span style="font-size: 12pt;">                    };</span></div><div><span style="font-size: 12pt;">                };</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        //////////////</span></div><div><span style="font-size: 12pt;">        if (report_tag==0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            sprintf(report,&quot;error:not_in_bed\t%s&quot;,LINE_IN);</span></div><div><span style="font-size: 12pt;">            fputs(report,ERR);</span></div><div><span style="font-size: 12pt;">        }else if(report_tag==1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    printf(&quot;filter is ended...\n&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    fclose (IN);</span></div><div><span style="font-size: 12pt;">    fclose (ON);</span></div><div><span style="font-size: 12pt;">    fclose (OUT);</span></div><div><span style="font-size: 12pt;">    fclose (ERR);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    return 0;</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;">////////////////////////////////</span></div><div><span style="font-size: 12pt;">int get_anno(char i[],char o[],char d[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    printf(&quot;start to anno...\n\n&quot;);</span></div><div><span style="font-size: 12pt;">    ////////</span></div><div><span style="font-size: 12pt;">    char idx_chr[20];</span></div><div><span style="font-size: 12pt;">    sscanf(&quot;NC_000001.10&quot;,&quot;%s&quot;,&amp;idx_chr);</span></div><div><span style="font-size: 12pt;">    long idx_start=0;</span></div><div><span style="font-size: 12pt;">    long idx_end=0;</span></div><div><span style="font-size: 12pt;">    float idx_seek=0;</span></div><div><span style="font-size: 12pt;">    float idx_diff=5000;</span></div><div><span style="font-size: 12pt;">    ////////////</span></div><div><span style="font-size: 12pt;">    int idx_tag=1;</span></div><div><span style="font-size: 12pt;">    float seek_down=0;</span></div><div><span style="font-size: 12pt;">    float seek_tmp=0;</span></div><div><span style="font-size: 12pt;">    //////////////////////</span></div><div><span style="font-size: 12pt;">    FILE *IN,*ON,*IDX,*OUT;</span></div><div><span style="font-size: 12pt;">    char file_idx[500];</span></div><div><span style="font-size: 12pt;">    sprintf(file_idx,&quot;%s.idx&quot;,d);</span></div><div><span style="font-size: 12pt;">    IN=fopen(i,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    ON=fopen(d,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    OUT=fopen(o,&quot;w&quot;);</span></div><div><span style="font-size: 12pt;">    IDX=fopen(file_idx,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    if (IN==NULL || ON==NULL || IDX==NULL || OUT==NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        printf(&quot;Attention:\tmust be something wrong in this files, please check them !\n&quot;);</span></div><div><span style="font-size: 12pt;">        return 0;</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    //////////////////</span></div><div><span style="font-size: 12pt;">    char report[50000];</span></div><div><span style="font-size: 12pt;">    char LINE_IN[50000];</span></div><div><span style="font-size: 12pt;">    char LINE_ON[50000];</span></div><div><span style="font-size: 12pt;">    char LINE_IDX[500];</span></div><div><span style="font-size: 12pt;">    fgets(LINE_IDX,sizeof(LINE_IDX),IDX);</span></div><div><span style="font-size: 12pt;">    LINE_IDX[strlen(LINE_IDX)-1]=' ';</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    while(fgets(LINE_IN,sizeof(LINE_IN),IN)!=NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strstr(LINE_IN,&quot;####&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        }else if (strstr(LINE_IN,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        char chr[20];</span></div><div><span style="font-size: 12pt;">        long start=0;</span></div><div><span style="font-size: 12pt;">        long end=0;</span></div><div><span style="font-size: 12pt;">        char ref[500];</span></div><div><span style="font-size: 12pt;">        char alt[500];</span></div><div><span style="font-size: 12pt;">        char com[500];</span></div><div><span style="font-size: 12pt;">        //////////</span></div><div><span style="font-size: 12pt;">        sscanf(LINE_IN,&quot;%s%d%d%s%s&quot;,chr,&amp;start,&amp;end,ref,alt);</span></div><div><span style="font-size: 12pt;">        if (strstr(chr,&quot;NC_0000&quot;) &amp;&amp; strlen(chr)&lt;=12)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (strlen(ref) &gt;= 200 || strlen(alt) &gt;= 200 || strlen(LINE_IN)&gt;=4998)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        sprintf(com,&quot;%s-%s&quot;,ref,alt);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        ///////////////////</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">//        printf(&quot;AAA\t%s\t%0.f\t%s\n&quot;,LINE_IN,seek_down,chr);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        while (idx_tag==1 &amp;&amp; (strcmp(chr,idx_chr)&gt;0 || (strcmp(chr,idx_chr)==0 &amp;&amp; start&gt;idx_end)))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            if (idx_seek &gt; seek_down)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                seek_down=idx_seek;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            if (fgets(LINE_IDX,sizeof(LINE_IDX),IDX)!=NULL)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                LINE_IDX[strlen(LINE_IDX)-1]=' ';</span></div><div><span style="font-size: 12pt;">                sscanf(LINE_IDX,&quot;%s%d%d%f&quot;,&amp;idx_chr,&amp;idx_start,&amp;idx_end,&amp;idx_seek);</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                idx_tag=0;</span></div><div><span style="font-size: 12pt;">                break;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            fseek(ON,seek_down,SEEK_SET);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        ///////////////</span></div><div><span style="font-size: 12pt;">        float seek_true=ftell(ON);</span></div><div><span style="font-size: 12pt;">        seek_true=seek_true-idx_diff;</span></div><div><span style="font-size: 12pt;">        if(seek_true&lt;0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            seek_true=0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        fseek(ON,seek_true,SEEK_SET);</span></div><div><span style="font-size: 12pt;">        //////////////////////</span></div><div><span style="font-size: 12pt;">        int report_tag=0;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">//        printf(&quot;AAA\t%s\t%0.f\n%s\t%d\t%d\n&quot;,LINE_IN,seek_down,chr,start,end);</span></div><div><span style="font-size: 12pt;">        while(fgets(LINE_ON,sizeof(LINE_ON),ON)!=NULL)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            char chr_2[500];</span></div><div><span style="font-size: 12pt;">            long start_2=0;</span></div><div><span style="font-size: 12pt;">            long end_2=0;</span></div><div><span style="font-size: 12pt;">            char ref_2[500];</span></div><div><span style="font-size: 12pt;">            char alt_2[500];</span></div><div><span style="font-size: 12pt;">            char com_2[500];</span></div><div><span style="font-size: 12pt;">            //////////////////////</span></div><div><span style="font-size: 12pt;">            if (strstr(LINE_ON,&quot;####&quot;))</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                if (report_tag==1)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    fputs(LINE_ON,OUT);</span></div><div><span style="font-size: 12pt;">                };</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            }else if (strstr(LINE_ON,&quot;NC_0000&quot;) &amp;&amp; (LINE_ON[0]=='N'))</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                if (report_tag==1)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    fseek(ON,seek_tmp,SEEK_SET);</span></div><div><span style="font-size: 12pt;">                    break;</span></div><div><span style="font-size: 12pt;">                };</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            sscanf(LINE_ON,&quot;%s%d%d%s%s&quot;,chr_2,&amp;start_2,&amp;end_2,ref_2,alt_2);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            if (strstr(chr_2,&quot;NC_0000&quot;) &amp;&amp; strlen(chr_2)&lt;=12)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            //////////</span></div><div><span style="font-size: 12pt;">//            LINE_ON[strlen(LINE_ON)-1]=' ';</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            if (strlen(ref_2) &gt;= 200 || strlen(alt_2) &gt;= 200 || strlen(LINE_ON)&gt;=4998)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            sprintf(com_2,&quot;%s-%s&quot;,ref_2,alt_2);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            //////////////////////</span></div><div><span style="font-size: 12pt;">//            printf(&quot;BBB\t%s\t%f\t%s\t%d\t%d\n&quot;,LINE_ON,seek_down,chr_2,start_2,end_2);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">                if (strcmp(chr,chr_2) &lt; 0)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    break;</span></div><div><span style="font-size: 12pt;">                }else if(strcmp(chr,chr_2) &gt; 0)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    continue;</span></div><div><span style="font-size: 12pt;">                }else</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    if (start &lt; start_2)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        break;</span></div><div><span style="font-size: 12pt;">                    }else if (start &gt; start_2)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        continue;</span></div><div><span style="font-size: 12pt;">                    }else</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        if (end &lt; end_2)</span></div><div><span style="font-size: 12pt;">                        {</span></div><div><span style="font-size: 12pt;">                            break;</span></div><div><span style="font-size: 12pt;">                        }else if (end &gt; end_2)</span></div><div><span style="font-size: 12pt;">                        {</span></div><div><span style="font-size: 12pt;">                            continue;</span></div><div><span style="font-size: 12pt;">                        }else</span></div><div><span style="font-size: 12pt;">                        {</span></div><div><span style="font-size: 12pt;">                            if (strcmp(com,com_2)&lt;0)</span></div><div><span style="font-size: 12pt;">                            {</span></div><div><span style="font-size: 12pt;">                                break;</span></div><div><span style="font-size: 12pt;">                            }else if(strcmp(com,com_2)&gt;0)</span></div><div><span style="font-size: 12pt;">                            {</span></div><div><span style="font-size: 12pt;">                                continue;</span></div><div><span style="font-size: 12pt;">                            }else</span></div><div><span style="font-size: 12pt;">                            {</span></div><div><span style="font-size: 12pt;">                                fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">                                report_tag=1;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">                                seek_tmp=ftell(ON);</span></div><div><span style="font-size: 12pt;">                                continue;</span></div><div><span style="font-size: 12pt;">                            };</span></div><div><span style="font-size: 12pt;">                        };</span></div><div><span style="font-size: 12pt;">                    };</span></div><div><span style="font-size: 12pt;">                };</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        //////////////</span></div><div><span style="font-size: 12pt;">        if (report_tag==0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    printf(&quot;annotating is ended...\n&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    fclose (IN);</span></div><div><span style="font-size: 12pt;">    fclose (ON);</span></div><div><span style="font-size: 12pt;">    fclose (IDX);</span></div><div><span style="font-size: 12pt;">    fclose (OUT);</span></div><div><span style="font-size: 12pt;">    return 0;</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;">//////////////////////////////////////////////////////</span></div><div><span style="font-size: 12pt;">////////////////////////////////</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">int get_db_combine(char i[],char o[],char d[], char n[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    printf(&quot;database combine anno...\n\n&quot;);</span></div><div><span style="font-size: 12pt;">    ////////</span></div><div><span style="font-size: 12pt;">    char idx_chr[20];</span></div><div><span style="font-size: 12pt;">    sscanf(&quot;NC_000001.10&quot;,&quot;%s&quot;,&amp;idx_chr);</span></div><div><span style="font-size: 12pt;">    long idx_start=0;</span></div><div><span style="font-size: 12pt;">    long idx_end=0;</span></div><div><span style="font-size: 12pt;">    float idx_seek=0;</span></div><div><span style="font-size: 12pt;">    float idx_diff=5000;</span></div><div><span style="font-size: 12pt;">    ////////////</span></div><div><span style="font-size: 12pt;">    int idx_tag=1;</span></div><div><span style="font-size: 12pt;">    float seek_down=0;</span></div><div><span style="font-size: 12pt;">    //////////////////////</span></div><div><span style="font-size: 12pt;">    FILE *IN,*ON,*IDX,*OUT;</span></div><div><span style="font-size: 12pt;">    char file_idx[500];</span></div><div><span style="font-size: 12pt;">    sprintf(file_idx,&quot;%s.idx&quot;,d);</span></div><div><span style="font-size: 12pt;">    IN=fopen(i,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    ON=fopen(d,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    OUT=fopen(o,&quot;w&quot;);</span></div><div><span style="font-size: 12pt;">    IDX=fopen(file_idx,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    if (IN==NULL || ON==NULL || IDX==NULL || OUT==NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        printf(&quot;Attention:\tmust be something wrong in this files, please check them !\n&quot;);</span></div><div><span style="font-size: 12pt;">        return 0;</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    //////////////////</span></div><div><span style="font-size: 12pt;">    char report[50000];</span></div><div><span style="font-size: 12pt;">    char LINE_IN[50000];</span></div><div><span style="font-size: 12pt;">    char LINE_ON[50000];</span></div><div><span style="font-size: 12pt;">    char LINE_IDX[500];</span></div><div><span style="font-size: 12pt;">    fgets(LINE_IDX,sizeof(LINE_IDX),IDX);</span></div><div><span style="font-size: 12pt;">    LINE_IDX[strlen(LINE_IDX)-1]=' ';</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    while(fgets(LINE_IN,sizeof(LINE_IN),IN)!=NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strstr(LINE_IN,&quot;####&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        }else if (strstr(LINE_IN,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        char chr[20];</span></div><div><span style="font-size: 12pt;">        long start=0;</span></div><div><span style="font-size: 12pt;">        long end=0;</span></div><div><span style="font-size: 12pt;">        char ref[500];</span></div><div><span style="font-size: 12pt;">        char alt[500];</span></div><div><span style="font-size: 12pt;">        char com[500];</span></div><div><span style="font-size: 12pt;">        //////////</span></div><div><span style="font-size: 12pt;">        sscanf(LINE_IN,&quot;%s%d%d%s%s&quot;,chr,&amp;start,&amp;end,ref,alt);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (strstr(chr,&quot;####&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        }else if (strstr(chr,&quot;NC_0000&quot;) &amp;&amp; strlen(chr)&lt;=12)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (strlen(ref) &gt;= 200 || strlen(alt) &gt;= 200 || strlen(LINE_IN)&gt;=4998 || end &lt; start)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">//            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        sprintf(com,&quot;%s-%s&quot;,ref,alt);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        ///////////////////</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">//        printf(&quot;AAA\t%s\t%0.f\t%s\n&quot;,LINE_IN,seek_down,chr);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        while (idx_tag==1 &amp;&amp; (strcmp(chr,idx_chr)&gt;0 || (strcmp(chr,idx_chr)==0 &amp;&amp; start&gt;idx_end)))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            if (idx_seek &gt; seek_down)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                seek_down=idx_seek;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            if (fgets(LINE_IDX,sizeof(LINE_IDX),IDX)!=NULL)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                LINE_IDX[strlen(LINE_IDX)-1]=' ';</span></div><div><span style="font-size: 12pt;">                sscanf(LINE_IDX,&quot;%s%d%d%f&quot;,&amp;idx_chr,&amp;idx_start,&amp;idx_end,&amp;idx_seek);</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                idx_tag=0;</span></div><div><span style="font-size: 12pt;">                break;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            fseek(ON,seek_down,SEEK_SET);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        ///////////////</span></div><div><span style="font-size: 12pt;">        float seek_true=ftell(ON);</span></div><div><span style="font-size: 12pt;">        seek_true=seek_true-idx_diff;</span></div><div><span style="font-size: 12pt;">        if(seek_true&lt;0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            seek_true=0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        fseek(ON,seek_true,SEEK_SET);</span></div><div><span style="font-size: 12pt;">        //////////////////////</span></div><div><span style="font-size: 12pt;">        int report_tag=0;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">//        printf(&quot;AAA\t%s\t%0.f\n%s\t%d\t%d\n&quot;,LINE_IN,seek_down,chr,start,end);</span></div><div><span style="font-size: 12pt;">        while(fgets(LINE_ON,sizeof(LINE_ON),ON)!=NULL)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            char chr_2[500];</span></div><div><span style="font-size: 12pt;">            long start_2=0;</span></div><div><span style="font-size: 12pt;">            long end_2=0;</span></div><div><span style="font-size: 12pt;">            char ref_2[500];</span></div><div><span style="font-size: 12pt;">            char alt_2[500];</span></div><div><span style="font-size: 12pt;">            char com_2[500];</span></div><div><span style="font-size: 12pt;">            //////////////////////</span></div><div><span style="font-size: 12pt;">            if (strstr(LINE_ON,&quot;NC_0000&quot;) &amp;&amp; (LINE_ON[0]=='N'))</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            sscanf(LINE_ON,&quot;%s%d%d%s%s&quot;,chr_2,&amp;start_2,&amp;end_2,ref_2,alt_2);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            if (strstr(chr_2,&quot;NC_0000&quot;) &amp;&amp; strlen(chr_2)&lt;=12)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            //////////</span></div><div><span style="font-size: 12pt;">//            LINE_ON[strlen(LINE_ON)-1]=' ';</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            if (strlen(ref_2) &gt;= 200 || strlen(alt_2) &gt;= 200 || strlen(LINE_ON)&gt;=4998 || end_2 &lt; start_2)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                continue;</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">            sprintf(com_2,&quot;%s-%s&quot;,ref_2,alt_2);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">            //////////////////////</span></div><div><span style="font-size: 12pt;">//            printf(&quot;BBB\t%s\t%f\t%s\t%d\t%d\n&quot;,LINE_ON,seek_down,chr_2,start_2,end_2);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">                if (strcmp(chr,chr_2) &lt; 0)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    break;</span></div><div><span style="font-size: 12pt;">                }else if(strcmp(chr,chr_2) &gt; 0)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    continue;</span></div><div><span style="font-size: 12pt;">                }else</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    if (start &lt; start_2)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        break;</span></div><div><span style="font-size: 12pt;">                    }else if (start &gt; start_2)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        continue;</span></div><div><span style="font-size: 12pt;">                    }else</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        if (end &lt; end_2)</span></div><div><span style="font-size: 12pt;">                        {</span></div><div><span style="font-size: 12pt;">                            break;</span></div><div><span style="font-size: 12pt;">                        }else if (end &gt; end_2)</span></div><div><span style="font-size: 12pt;">                        {</span></div><div><span style="font-size: 12pt;">                            continue;</span></div><div><span style="font-size: 12pt;">                        }else</span></div><div><span style="font-size: 12pt;">                        {</span></div><div><span style="font-size: 12pt;">                            if (strcmp(com,com_2)&lt;0)</span></div><div><span style="font-size: 12pt;">                            {</span></div><div><span style="font-size: 12pt;">                                break;</span></div><div><span style="font-size: 12pt;">                            }else if(strcmp(com,com_2)&gt;0)</span></div><div><span style="font-size: 12pt;">                            {</span></div><div><span style="font-size: 12pt;">                                continue;</span></div><div><span style="font-size: 12pt;">                            }else</span></div><div><span style="font-size: 12pt;">                            {</span></div><div><span style="font-size: 12pt;">                                sprintf(report,&quot;%s\t####%s\t%s&quot;,LINE_IN,n,LINE_ON);</span></div><div><span style="font-size: 12pt;">                                fputs(report,OUT);</span></div><div><span style="font-size: 12pt;">                                report_tag=1;</span></div><div><span style="font-size: 12pt;">                                break;</span></div><div><span style="font-size: 12pt;">                            };</span></div><div><span style="font-size: 12pt;">                        };</span></div><div><span style="font-size: 12pt;">                    };</span></div><div><span style="font-size: 12pt;">                };</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        //////////////</span></div><div><span style="font-size: 12pt;">        if (report_tag==0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    printf(&quot;database combine is ended...\n&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    fclose (IN);</span></div><div><span style="font-size: 12pt;">    fclose (ON);</span></div><div><span style="font-size: 12pt;">    fclose (IDX);</span></div><div><span style="font-size: 12pt;">    fclose (OUT);</span></div><div><span style="font-size: 12pt;">    return 0;</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;">//////////////////////////////////////////////////////</span></div><div><span style="font-size: 12pt;">////////////////////////////////</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">int get_crush(char d[],char o[], char n[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    printf(&quot;database crush start...\n\n&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    //////////////////////</span></div><div><span style="font-size: 12pt;">    FILE *IN,*OUT;</span></div><div><span style="font-size: 12pt;">    IN=fopen(d,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    OUT=fopen(o,&quot;w&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    if (IN==NULL || OUT==NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        printf(&quot;Attention:\tmust be something wrong in this files, please check them !\n&quot;);</span></div><div><span style="font-size: 12pt;">        return 0;</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    //////////////////</span></div><div><span style="font-size: 12pt;">    char LINE_IN[50000];</span></div><div><span style="font-size: 12pt;">    char crush_tag[500];</span></div><div><span style="font-size: 12pt;">    sprintf(crush_tag,&quot;####%s&quot;,n);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    while(fgets(LINE_IN,sizeof(LINE_IN),IN)!=NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strstr(LINE_IN,crush_tag))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            ////next;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            fputs(LINE_IN,OUT);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    printf(&quot;database crush ended...\n&quot;);</span></div><div><span style="font-size: 12pt;">    fclose (IN);</span></div><div><span style="font-size: 12pt;">    fclose (OUT);</span></div><div><span style="font-size: 12pt;">    return 0;</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;">//////////////////////////////////////////////////////</span></div><div><span style="font-size: 12pt;">int get_check(char d[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    printf(&quot;start to check the database...\n&quot;);</span></div><div><span style="font-size: 12pt;">    char buff_chr[20];</span></div><div><span style="font-size: 12pt;">    sscanf(&quot;NC_000001.10&quot;,&quot;%s&quot;,&amp;buff_chr);</span></div><div><span style="font-size: 12pt;">    long buff_start=0;</span></div><div><span style="font-size: 12pt;">    long buff_end=0;</span></div><div><span style="font-size: 12pt;">    char buff_com[500];</span></div><div><span style="font-size: 12pt;">    char check='N';</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    FILE *ON;</span></div><div><span style="font-size: 12pt;">    ON=fopen(d,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    if (ON==NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        printf(&quot;Attention:\tmust be something wrong in this files, please check them !\n&quot;);</span></div><div><span style="font-size: 12pt;">        return -1;</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    char LINE[50000];</span></div><div><span style="font-size: 12pt;">    while ((fgets(LINE,sizeof(LINE),ON))!=NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strstr(LINE,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        char chr[20];</span></div><div><span style="font-size: 12pt;">        long start=0;</span></div><div><span style="font-size: 12pt;">        long end=0;</span></div><div><span style="font-size: 12pt;">        char ref[500];</span></div><div><span style="font-size: 12pt;">        char alt[500];</span></div><div><span style="font-size: 12pt;">        char com_1[500];</span></div><div><span style="font-size: 12pt;">//        printf(&quot;AAA\t%s\n&quot;,LINE);</span></div><div><span style="font-size: 12pt;">        //////////</span></div><div><span style="font-size: 12pt;">        LINE[strlen(LINE)-1]=' ';</span></div><div><span style="font-size: 12pt;">        sscanf(LINE,&quot;%s%d%d%s%s&quot;,&amp;chr,&amp;start,&amp;end,&amp;ref,&amp;alt);</span></div><div><span style="font-size: 12pt;">        if (chr[0]!=check || strlen(chr)&gt;12)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (strlen(ref)&gt;=200 || strlen(alt)&gt;=200 || strlen(LINE)&gt;=4998)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;\n\tattention:length_bg_than_200bp ! ignore it !!!\n\t%s\n\t%s\n\t%s\n&quot;,ref,alt,LINE);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        }else if(end &lt; start)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;\n\terror:\tDatabase format is invalid...\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\n\tend lt start:\t%s\t%d\t%d\t%s\n&quot;,chr,start,end,com_1);</span></div><div><span style="font-size: 12pt;">            exit(0);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        sprintf(com_1,&quot;%s-%s&quot;,ref,alt);</span></div><div><span style="font-size: 12pt;">        //////////////</span></div><div><span style="font-size: 12pt;">        if(strcmp(ref,&quot;-&quot;)==0 &amp;&amp; ((end-start)!=1))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;\n\t%s\t%d\t%d\t%s\t%s\n&quot;,chr,start,end,ref,alt);</span></div><div><span style="font-size: 12pt;">            goto CASE_LAST;                            </span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        ////////////////</span></div><div><span style="font-size: 12pt;">        int wrong=0;</span></div><div><span style="font-size: 12pt;">        char reason[500];</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (strcmp(chr,buff_chr) &gt; 0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            wrong=0;</span></div><div><span style="font-size: 12pt;">        }else if(strcmp(chr,buff_chr) &lt; 0)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            wrong=1;</span></div><div><span style="font-size: 12pt;">            sprintf(reason,&quot;%s &lt; %s&quot;,chr,buff_chr);</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            if(start &lt; buff_start)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                wrong=1;</span></div><div><span style="font-size: 12pt;">                sprintf(reason,&quot;%d&lt;%d:start&quot;,start,buff_start);</span></div><div><span style="font-size: 12pt;">            }else if (start &gt; buff_start)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                wrong=0;</span></div><div><span style="font-size: 12pt;">            }else</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                if (end &lt; buff_end)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    wrong=1;</span></div><div><span style="font-size: 12pt;">                    sprintf(reason,&quot;%d&lt;%d:end&quot;,end,buff_end);</span></div><div><span style="font-size: 12pt;">                }else if (end &gt; buff_end)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    wrong=0;</span></div><div><span style="font-size: 12pt;">                }else</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    if (strcmp(com_1,buff_com)&lt;0)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        wrong=1;</span></div><div><span style="font-size: 12pt;">                        sprintf(reason,&quot;%s &lt; %s&quot;,com_1,buff_com);</span></div><div><span style="font-size: 12pt;">                    }else if(strcmp(com_1,buff_com)&gt;0)</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        wrong=0;</span></div><div><span style="font-size: 12pt;">                    }else</span></div><div><span style="font-size: 12pt;">                    {</span></div><div><span style="font-size: 12pt;">                        wrong=0;</span></div><div><span style="font-size: 12pt;">                    };</span></div><div><span style="font-size: 12pt;">                };</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">        /////////////////</span></div><div><span style="font-size: 12pt;">        if (wrong==1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;\n\terror:\tDatabase format is invalid...\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\n\tbefore:\t%s\t%d\t%d\t%s\n&quot;,buff_chr,buff_start,buff_end,buff_com);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\n\tbehind:\t%s\t%d\t%d\t%s\n&quot;,chr,start,end,com_1);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\n\tReason:%s\n&quot;,reason);</span></div><div><span style="font-size: 12pt;">            goto CASE_LAST;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            sscanf(chr,&quot;%s&quot;,&amp;buff_chr);</span></div><div><span style="font-size: 12pt;">            buff_start=start;</span></div><div><span style="font-size: 12pt;">            buff_end=end;</span></div><div><span style="font-size: 12pt;">            sscanf(com_1,&quot;%s&quot;,&amp;buff_com);</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    ////////////////</span></div><div><span style="font-size: 12pt;">    CASE_LAST:printf(&quot;checking is ended ...\n\n&quot;);</span></div><div><span style="font-size: 12pt;">    return 0;</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">int get_sort(char i[],char o[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    printf(&quot;start to sort the database...\n\n&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    char program[]=&quot;sort -k1,1 -k2,2n -k3,3n -k4,4 -k5,5&quot;;</span></div><div><span style="font-size: 12pt;">    char command[1000];</span></div><div><span style="font-size: 12pt;">    sprintf(command,&quot;%s %s &gt; %s\n&quot;,program,i,o);</span></div><div><span style="font-size: 12pt;">    system(command);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    printf(&quot;sorting is ended ...\n\n&quot;);</span></div><div><span style="font-size: 12pt;">    return 0;</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">int get_index(char d[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    printf(&quot;start to index the database ...\n\n&quot;);</span></div><div><span style="font-size: 12pt;">    FILE *IN,*OUT;</span></div><div><span style="font-size: 12pt;">    char out_file[100];</span></div><div><span style="font-size: 12pt;">    sprintf(out_file,&quot;%s.idx&quot;,d);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    IN=fopen(d,&quot;r&quot;);</span></div><div><span style="font-size: 12pt;">    OUT=fopen(out_file,&quot;w&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    if (IN==NULL || OUT==NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        printf(&quot;Attention:\tmust be something wrong in this files, please check them !\n&quot;);</span></div><div><span style="font-size: 12pt;">        return -1;</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    char LINE[50000];</span></div><div><span style="font-size: 12pt;">    char buff_chr[20];buff_chr[0]='\0';</span></div><div><span style="font-size: 12pt;">    long buff_start=0;</span></div><div><span style="font-size: 12pt;">    long buff_end=0;</span></div><div><span style="font-size: 12pt;">    float seek=0;</span></div><div><span style="font-size: 12pt;">    char report[1000];</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    while(fgets(LINE,sizeof(LINE),IN)!=NULL)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strstr(LINE,&quot;NC_0000&quot;))</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        char tmp_chr[20];</span></div><div><span style="font-size: 12pt;">        long tmp_start=0;</span></div><div><span style="font-size: 12pt;">        long tmp_end=0;</span></div><div><span style="font-size: 12pt;">        sscanf(LINE,&quot;%s%d%d&quot;,&amp;tmp_chr,&amp;tmp_start,&amp;tmp_end);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (strstr(tmp_chr,&quot;NC_0000&quot;) &amp;&amp; strlen(tmp_chr)&lt;=12)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (strlen(LINE)&gt;=4998)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;%s\n\terror:length_bg_than_5000 bits ! ignore it !!!\n&quot;,LINE);</span></div><div><span style="font-size: 12pt;">            continue;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        if (buff_chr==NULL || strlen(buff_chr)&lt;1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            sscanf(tmp_chr,&quot;%s&quot;,&amp;buff_chr);</span></div><div><span style="font-size: 12pt;">            buff_start=tmp_start;</span></div><div><span style="font-size: 12pt;">            seek=ftell(IN);</span></div><div><span style="font-size: 12pt;">            sprintf(report,&quot;%s\t%d\t%d\t%.0f\n&quot;,tmp_chr,tmp_start,tmp_end,seek);</span></div><div><span style="font-size: 12pt;">            fputs(report,OUT);</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            if (strcmp(tmp_chr,buff_chr)==0)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                if ((tmp_start - buff_start) &gt; 100000)</span></div><div><span style="font-size: 12pt;">                {</span></div><div><span style="font-size: 12pt;">                    buff_start=tmp_start;</span></div><div><span style="font-size: 12pt;">                    seek=ftell(IN);</span></div><div><span style="font-size: 12pt;">                    sprintf(report,&quot;%s\t%d\t%d\t%.0f\n&quot;,tmp_chr,tmp_start,tmp_end,seek);</span></div><div><span style="font-size: 12pt;">                    fputs(report,OUT);</span></div><div><span style="font-size: 12pt;">                };</span></div><div><span style="font-size: 12pt;">            }else if(strcmp(tmp_chr,buff_chr)&lt;0)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                printf(&quot;\n\t the database file is error !!!\n\n&quot;);</span></div><div><span style="font-size: 12pt;">                exit(0);</span></div><div><span style="font-size: 12pt;">            }else if(strcmp(tmp_chr,buff_chr)&gt;0)</span></div><div><span style="font-size: 12pt;">            {</span></div><div><span style="font-size: 12pt;">                sscanf(tmp_chr,&quot;%s&quot;,&amp;buff_chr);</span></div><div><span style="font-size: 12pt;">                buff_start=tmp_start;</span></div><div><span style="font-size: 12pt;">                seek=ftell(IN);</span></div><div><span style="font-size: 12pt;">                sprintf(report,&quot;%s\t%d\t%d\t%.0f\n&quot;,tmp_chr,tmp_start,tmp_end,seek);</span></div><div><span style="font-size: 12pt;">                fputs(report,OUT);</span></div><div><span style="font-size: 12pt;">            };</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    fclose (IN);</span></div><div><span style="font-size: 12pt;">    fclose (OUT);</span></div><div><span style="font-size: 12pt;">    printf(&quot;indexing is ended ...\n&quot;);</span></div><div><span style="font-size: 12pt;">    return(0);</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">int help(char prog[],char cmd[],char i[],char o[],char d[],char n[])</span></div><div><span style="font-size: 12pt;">{</span></div><div><span style="font-size: 12pt;">    if (strlen(cmd)&gt;0 &amp;&amp; strcmp(cmd,&quot;check&quot;)==0)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strlen(d)&lt;1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;Usage:\tannotools check -d [database]\n\n&quot;);</span></div><div><span style="font-size: 12pt;">            return -1;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            get_check(d);</span></div><div><span style="font-size: 12pt;">            return 0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    }else if (strlen(cmd)&gt;0 &amp;&amp; strcmp(cmd,&quot;sort&quot;)==0)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strlen(i)&lt;1 || strlen(o)&lt;1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;Usage:\tannotools sort -i [database] -o [db_sorted]\n\n&quot;);</span></div><div><span style="font-size: 12pt;">            return -1;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            get_sort(i,o);</span></div><div><span style="font-size: 12pt;">            return 0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    }else if (strlen(cmd)&gt;0 &amp;&amp; strcmp(cmd,&quot;index&quot;)==0)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strlen(d)&lt;1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;Usage:\tannotools index -d [database]\n\n&quot;);</span></div><div><span style="font-size: 12pt;">            return -1;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            get_index(d);</span></div><div><span style="font-size: 12pt;">            return 0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    }else if(strlen(cmd)&gt;0 &amp;&amp; strcmp(cmd,&quot;intersect&quot;)==0)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strlen(d)&lt;1|| strlen(i)&lt;1 || strlen(o)&lt;1 || strlen(n)&lt;1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;Usage:\tannotools intersect -i [bed] -d [database] -o [outfile] -n [dadabase_name]\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-i\tOnly with the following format:\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t\tchr1\t69270\t69270\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t\tchr1\t69270\t69271\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t\tchr1\t69271\t69271\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-o\tOut file\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-d\tDatabase that needs to be annotated, file format refer to [-i]\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-n\tThe name of additional database\n&quot;);</span></div><div><span style="font-size: 12pt;">            return -1;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            get_intersect(i,o,d,n);</span></div><div><span style="font-size: 12pt;">            return 0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    }else if(strlen(cmd)&gt;0 &amp;&amp; strcmp(cmd,&quot;filter&quot;)==0)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strlen(d)&lt;1|| strlen(i)&lt;1 || strlen(o)&lt;1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;Usage:\tannotools filter -i [bed] -d [database] -o [outfile]\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-i\tOnly with the following format:\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t\tchr1\t69270\t69270\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t\tchr1\t69270\t69271\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t\tchr1\t69271\t69271\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-d\tDatabase that needs to be annotated, file format refer to [-i]\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-o\tOut file\n&quot;);</span></div><div><span style="font-size: 12pt;">            return -1;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            get_filter(i,o,d);</span></div><div><span style="font-size: 12pt;">            return 0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    }else if(strlen(cmd)&gt;0 &amp;&amp; strcmp(cmd,&quot;combine&quot;)==0)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strlen(d)&lt;1|| strlen(i)&lt;1 || strlen(o)&lt;1 || strlen(n)&lt;1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;Usage:\tannotools combine -i [database] -d [additional database] -o [outfile] -n [database_name]\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-i\tIntegrated database\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-d\tAdditional database\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-n\tThe name of additional database\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-o\tOut file\n&quot;);</span></div><div><span style="font-size: 12pt;">            return -1;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            get_db_combine(i,o,d,n);</span></div><div><span style="font-size: 12pt;">            return 0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    }else if(strlen(cmd)&gt;0 &amp;&amp; strcmp(cmd,&quot;crush&quot;)==0)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strlen(d)&lt;1 || strlen(o)&lt;1 || strlen(n)&lt;1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;Usage:\tannotools crush -d [database] -o [outfile] -n [database to be shredded]\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-d\tIntegrated database\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-n\tThe name of database to be shredded\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-o\tOut file\n&quot;);</span></div><div><span style="font-size: 12pt;">            return -1;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            get_crush(d,o,n);</span></div><div><span style="font-size: 12pt;">            return 0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    }else if(strlen(cmd)&gt;0 &amp;&amp; strcmp(cmd,&quot;anno&quot;)==0)</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        if (strlen(d)&lt;1|| strlen(i)&lt;1 || strlen(o)&lt;1)</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            printf(&quot;Usage:\tannotools anno -i [bed] -d [database] -o [outfile]\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-i\tOnly with the following format:\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t\tchr1\t69270\t69270\tA\tG\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t\tchr1\t69270\t69271\t-\tG\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t\tchr1\t69270\t69270\tA\t-\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-d\tDatabase that needs to be annotated, file format refer to [-i]\n&quot;);</span></div><div><span style="font-size: 12pt;">            printf(&quot;\t-o\tOut file\n&quot;);</span></div><div><span style="font-size: 12pt;">            return -1;</span></div><div><span style="font-size: 12pt;">        }else</span></div><div><span style="font-size: 12pt;">        {</span></div><div><span style="font-size: 12pt;">            get_anno(i,o,d);</span></div><div><span style="font-size: 12pt;">            return 0;</span></div><div><span style="font-size: 12pt;">        };</span></div><div><span style="font-size: 12pt;">    }else</span></div><div><span style="font-size: 12pt;">    {</span></div><div><span style="font-size: 12pt;">        printf(&quot;Usage:\tannotools &lt;subcommand&gt; [options]\n&quot;);</span></div><div><span style="font-size: 12pt;">        printf(&quot;\t[check]\t\t\tTo check whether the data meets the standard format !\n&quot;);</span></div><div><span style="font-size: 12pt;">        printf(&quot;\t[sort]\t\t\tTo sort the database !\n&quot;);</span></div><div><span style="font-size: 12pt;">        printf(&quot;\t[index]\t\t\tTo index the database !\n&quot;);</span></div><div><span style="font-size: 12pt;">        printf(&quot;\t[filter]\t\tTo filter the data not in the bed !\n&quot;);</span></div><div><span style="font-size: 12pt;">        printf(&quot;\t[combine]\t\tTo combine the databases !\n&quot;);</span></div><div><span style="font-size: 12pt;">        printf(&quot;\t[crush]\t\t\tTo smash the trash in the database !\n&quot;);</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">        printf(&quot;\t[intersect]\t\tTo anno the database by finding intersection !\n&quot;);</span></div><div><span style="font-size: 12pt;">        printf(&quot;\t[anno]\t\t\tTo anno the database by finding the mutation !\n\n&quot;);</span></div><div><span style="font-size: 12pt;">        return -1;</span></div><div><span style="font-size: 12pt;">    };</span></div><div><span style="font-size: 12pt;">    return 1;</span></div><div><span style="font-size: 12pt;">};</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div></span>
</div></body></html> 