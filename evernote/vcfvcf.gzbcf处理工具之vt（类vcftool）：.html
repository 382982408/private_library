<html>
<head>
  <title>vcf/vcf.gz/bcf处理工具之vt（类vcftool）：</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1112"/>
<h1>vcf/vcf.gz/bcf处理工具之vt（类vcftool）：</h1>

<div>
<span><div><span style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(255, 0, 0);"><font face="Times New Roman">vcf/vcf.gz/bcf处理工具之vt（类vcftool）：</font></span></span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-variant-caps: normal; font-variant-ligatures: normal;"><font face="Times New Roman">vt is a variant tool set that discovers short variants from Next Generation Sequencing data.</font></span></div><div><font face="Times New Roman" style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">1）软件安装</span></font></div><div><font face="Times New Roman">    地址： git clone <a href="https://github.com/atks/vt.git" style="color: rgb(255, 0, 0);">https://github.com/atks/vt.git</a></font></div><div><font face="Times New Roman">    说明文档：<a href="https://genome.sph.umich.edu/wiki/Vt#Installation" style="color: rgb(255, 0, 0);">https://genome.sph.umich.edu/wiki/Vt#Installation</a></font></div><div><font face="Times New Roman">    Help page on <a href="http://statgen.sph.umich.edu/wiki/Vt" style="color: rgb(255, 0, 0);">http://statgen.sph.umich.edu/wiki/Vt</a> </font></div><div><font face="Times New Roman">    本地地址：/mnt/X500/farmers/luozw/bin/anaconda/envs/bioinfoLzw/bin/vt</font></div><div><span style="font-weight: bold;"><font face="Times New Roman" style="font-size: 12pt;">2）命令详解：</font></span></div><div><font face="Times New Roman">        4 General Features and notes</font></div><div><font face="Times New Roman">            4.1 Common options</font></div><div><font face="Times New Roman">            4.2 Uncompressed BCF streams</font></div><div><font face="Times New Roman" style="color: rgb(255, 0, 0);">            4.3 Filters<span>    </span><span>    </span><span>    突变过滤，区间+表达式。和bcftools 功能差不多。</span></font></div><div><font face="Times New Roman">            4.4 Alternate headers</font></div><div><font face="Times New Roman">            4.5 General cases of Ploidy and Alleles</font></div><div><font face="Times New Roman">            4.6 BCF Compression Levels vs Compression Time</font></div><div><font face="Times New Roman">        5 VCF Manipulation</font></div><div><font face="Times New Roman">            5.1 View</font></div><div><font face="Times New Roman">            5.2 Index</font></div><div><font face="Times New Roman"><font style="color: rgb(227, 0, 0);">       </font><font color="#FF0000">     5.3 Sorting        </font></font></div><div><font color="#FF0000" face="Times New Roman">            5.4 Normalization        突变标准化</font></div><div><font color="#FF0000" face="Times New Roman">       <font>     5.5 Decompose biallelic block substitutions<span>    </span><span>    拆分DELINS为多个突变</span></font></font></div><div><font color="#FF0000" face="Times New Roman">            5.6 Decompose<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>     拆分一行多条突变</span></font></div><div><font face="Times New Roman">    <font style="color: rgb(255, 0, 0);">        5.7 Drop duplicate variants<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    去重复</span></font></font></div><div><font face="Times New Roman">            5.8 Paste</font></div><div><font face="Times New Roman" style="color: rgb(255, 0, 0);">            5.9 Concatenate<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    同bcftools cat</span></font></div><div><font face="Times New Roman">    <font style="color: rgb(255, 0, 0);">        5.10 Remove info tags<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    去除INFO列，某一tag 的信息</span></font></font></div><div><font face="Times New Roman">         <font style="color: rgb(255, 0, 0);">   5.11 Filter</font></font></div><div><font face="Times New Roman">            5.12 Filter overlap</font></div><div><font face="Times New Roman">            5.13 Validate</font></div><div><font color="#FF0000" face="Times New Roman">            5.14 <span style="font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">info2tab         </span>Extract INFO fields to a tab delimited file</font></div><div><font face="Times New Roman"><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span> <span style="color: rgb(0, 0, 0); font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">vt info2tab in.bcf -u PASS -t EX_RL,FZ_RL,MDUST,LOBSTR,VNTRSEEK,RMSK,EX_REPEAT_TRACT</span><br/></font></div><div><font face="Times New Roman">        6 VCF Inspection and Evaluation<span>    </span><span>    </span></font></div><div><font face="Times New Roman" style="color: rgb(255, 0, 0);">            6.1 Peek<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span> <span style="font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Summarizes the variants in a VCF file</span></font></div><div><font face="Times New Roman">            6.2 Partition<span>    </span><span>    </span><span>    </span><span>    </span><span>    </span> <span style="color: rgb(0, 0, 0); font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Partition variants from two data sets.</span></font></div><div><font face="Times New Roman">            6.3 Multi Partition</font></div><div><font face="Times New Roman">            6.4 Annotate Regions<span>    </span><span>    </span> <span style="color: rgb(0, 0, 0); font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Annotates regions in a VCF file. The BED file should be bgzipped and indexed with tabix.</span></font></div><div><font face="Times New Roman" style="color: rgb(255, 0, 0);">            6.5 Annotate Variants         <span style="font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Annotates variants in a VCF file.仅支持特定数据库的注释。</span></font></div><div><font face="Times New Roman">            6.6 Compute Features<span>    </span><span>    </span></font></div><div><font face="Times New Roman">            6.7 Estimate</font></div><div><font face="Times New Roman">            6.8 Profile Mendelian Errors</font></div><div><font face="Times New Roman">            6.9 Profile SNPs</font></div><div><font face="Times New Roman">            6.10 Profile Indels</font></div><div><font face="Times New Roman">            6.11 Profile VNTRs</font></div><div><font face="Times New Roman">            6.12 Profile NA12878</font></div><div><font face="Times New Roman">        7 Variant Calling</font></div><div><font face="Times New Roman">            7.1 Discover</font></div><div><font face="Times New Roman">            7.2 Merge candidate variants</font></div><div><font face="Times New Roman">            7.3 Remove overlap</font></div><div><font face="Times New Roman">            7.4 Annotate Indels</font></div><div><font face="Times New Roman">            7.5 Construct Probes</font></div><div><font face="Times New Roman">            7.6 Genotype</font></div><div><font face="Times New Roman" style="font-size: 12pt;"><b>    Common options</b></font></div><div><font face="Times New Roman">       -i   multiple intervals in &lt;seq&gt;:&lt;start&gt;-&lt;end&gt; format delimited by commas.</font></div><div><font face="Times New Roman">       -I   multiple intervals in &lt;seq&gt;:&lt;start&gt;-&lt;end&gt; format listed in a text file line by line.</font></div><div><font face="Times New Roman">       -o   defines the out file which and has the STDOUT set as the default.</font></div><div><font face="Times New Roman">            vt recognizes the appropriate output by file extension.</font></div><div><font face="Times New Roman">            &lt;name&gt;.vcf     - uncompressed VCF</font></div><div><font face="Times New Roman">            &lt;name&gt;.vcf.gz  - compressed VCF</font></div><div><font face="Times New Roman">            &lt;name&gt;.bcf     - BCF</font></div><div><font face="Times New Roman">            You may modify the STDOUT to output the binary version of the format.  Uncompressed</font></div><div><font face="Times New Roman">            VCF and BCF streams are indicated by - and + respectively.  </font></div><div><font face="Times New Roman">       -f  filter expression</font></div><div><font face="Times New Roman">       -s  sequential region selection as opposed to random access of regions specified by the i option.</font></div><div><font face="Times New Roman"><br/></font></div><div><span style="font-weight: bold;"><font face="Times New Roman">3）示例：</font></span></div><div><font face="Times New Roman">        3.1）vt decompose <span style="color: rgb(255, 0, 0);">（vcf 同位点多突变拆分工具）</span></font></div><div><font face="Times New Roman">               示例： vt decompose 1000G_phase1.snps.indel.b37.vcf -s -o 1000G_phase1.snps.indel.b37.vcf_hand.vcf</font></div><div><font face="Times New Roman">                <span style="color: rgb(255, 0, 0);">存在问题1：只能拆分，不能左对齐 （</span><span style="color: rgb(255, 0, 0);">1       874449  .       TC      CC      1268.29 PASS    AC=1;AC_AFR=0）</span></font></div><div><span style="color: rgb(255, 0, 0);"><font face="Times New Roman">                解决问题：可以拆分多突变频率信息</font></span></div><div><font face="Times New Roman">                                1       13404   .       G       A,T     136.58  VQSRTrancheSNP99.60to99.80      AC=2,1</font></div><div><font face="Times New Roman">                                1       13404   .       G       A       136.58  VQSRTrancheSNP99.60to99.80      AC=2;</font></div><div><font face="Times New Roman">                                1       13404   .       G       T       136.58  VQSRTrancheSNP99.60to99.80      AC=1;</font></div><div><font face="Times New Roman"><span style="color: rgb(227, 0, 0);">    </span><span style="color: rgb(227, 0, 0);">    注意：用</span> <span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-variant-caps: normal; font-variant-ligatures: normal;">gatk LeftAlignAndTrimVariants</span> <span style="color: rgb(227, 0, 0);">-split-multi-allelics 拆出来的位点没有info 信息，只有变异，所以一定要先要用vt拆分变异，再处理。</span></font></div><div><font face="Times New Roman">                <img src="vcfvcf.gzbcf处理工具之vt（类vcftool）：_files/Image.png" type="image/png" data-filename="Image.png" width="799"/></font></div><div><font face="Times New Roman"><br/></font></div><div><font face="Times New Roman">        3.2）Annotate Variants（仅可以注释下面资源包中的信息）</font></div><div><font face="Times New Roman">                 Annotates variants in a VCF file. The GENCODE annotation file should be bgzipped and indexed with tabix. This is available in the <a href="https://genome.sph.umich.edu/wiki/Vt#Resource_Bundle" style="color: rgb(255, 0, 0);">vt resource bundle</a>.</font></div><div><font face="Times New Roman">                 资源地址：<a href="ftp://share.sph.umich.edu/vt/grch37" style="color: rgb(255, 0, 0);">ftp://share.sph.umich.edu/vt/grch37</a></font></div><div><font face="Times New Roman">                 示例：vt annotate_variants mills.vcf -r hs37d5.fa -g gencode.v19.annotation.gtf.gz</font></div><div><font face="Times New Roman">        3.3）Filters</font></div><div><font face="Times New Roman"><span>    </span><span>    </span><span>    </span><span>    </span> <span style="color: rgb(0, 0, 0); font-size: medium; font-variant-caps: normal; font-variant-ligatures: normal;">This allows you to extract biallelic indels that are passed on chromosome 20.</span></font></div><div><font face="Times New Roman">     <span>    </span><span>    </span><span>    </span><font style="color: rgb(255, 0, 0);"><span>    </span> vt view vt.bcf -f &quot;N_ALLELE==2&amp;&amp;VTYPE==INDEL&amp;&amp;PASS&quot; -i 20</font></font></div><div><font style="font-family: &quot;Times New Roman&quot;; font-size: 12pt;">  <b>           <span> </span>Other examples of filters：</b></font></div><div style="text-align: start;">                    #all variants with a SNP in them</div><div style="text-align: start;"><font style="color: rgb(255, 0, 0);">                    VTYPE&amp;SNP</font></div><div style="text-align: start;">                    #Simple insertions of length 1</div><div style="text-align: start;">                    VTYPE==INDEL&amp;&amp;DLEN==1</div><div style="text-align: start;">                    #Indels of length 1</div><div style="text-align: start;">                    VTYPE==INDEL&amp;&amp;LEN==1</div><div style="text-align: start;">                    INFO fields || INFO.&lt;tag&gt;</div><div style="text-align: start;">                   <font style="color: rgb(255, 0, 0);"> A/C SNPs : REF=='A' &amp;&amp; ALT=='C'</font></div><div style="text-align: start;">                    AC type of STRs : REF=~'^.(AC)+$' || ALT=~'^.(AC)+$'</div><div style="text-align: start;">                    Passed biallelic SNPs only : PASS&amp;&amp;VTYPE==SNP&amp;&amp;N_ALLELE==2</div><div style="text-align: start;"><font color="#FF0000">                    Passed Common biallelic SNPs only : PASS&amp;&amp;VTYPE==SNP&amp;&amp;N_ALLELE==2&amp;&amp;INFO.AF&gt;0.005</font></div><div style="text-align: start;"><font color="#FF0000">                    Passed Common biallelic SNPs or rare indels : (PASS&amp;&amp;VTYPE==SNP&amp;&amp;N_ALLELE==2&amp;&amp;INFO.AF&gt;0.005)||(VTYPE&amp;INDEL&amp;&amp;INFO.AF&lt;=0.005)</font></div><div style="text-align: start;"><font color="#FF0000">                    Passed Common biallelic SNPs or rare indels : ((PASS&amp;&amp;VTYPE==SNP&amp;&amp;N_ALLELE==2&amp;&amp;INFO.AF&gt;0.005)||(VTYPE&amp;INDEL&amp;&amp;INFO.AF&lt;=0.005))&amp;&amp;QUAL&gt;100</font></div><div style="text-align: start;">                    with quality greater than 100</div><div style="text-align: start;"><font style="color: rgb(255, 0, 0);">                    Failed rare variants : ~PASS&amp;&amp;(INFO.AC/INFO.AN&lt;0.005)</font><br/></div><div><font face="Times New Roman"><br/></font></div><div><font face="Times New Roman"><br/></font></div><div><font face="Times New Roman"><br/></font></div><div><font face="Times New Roman"><a href="vcfvcf.gzbcf处理工具之vt（类vcftool）：_files/vt"><img src="vcfvcf.gzbcf处理工具之vt（类vcftool）：_files/83397292da3500ae6551a3701540af43.png" alt="vt"></a></font></div><div><br/></div></span>
</div></body></html> 